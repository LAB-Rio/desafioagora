(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}
var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}
return n[o].exports}
var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){(function(){var root=this;var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var
push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var
nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create;var Ctor=function(){};var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj;};if(typeof exports!=='undefined'){if(typeof module!=='undefined'&&module.exports){exports=module.exports=_;}
exports._=_;}else{root._=_;}
_.VERSION='1.8.3';var optimizeCb=function(func,context,argCount){if(context===void 0)return func;switch(argCount==null?3:argCount){case 1:return function(value){return func.call(context,value);};case 2:return function(value,other){return func.call(context,value,other);};case 3:return function(value,index,collection){return func.call(context,value,index,collection);};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection);};}
return function(){return func.apply(context,arguments);};};var cb=function(value,context,argCount){if(value==null)return _.identity;if(_.isFunction(value))return optimizeCb(value,context,argCount);if(_.isObject(value))return _.matcher(value);return _.property(value);};_.iteratee=function(value,context){return cb(value,context,Infinity);};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(length<2||obj==null)return obj;for(var index=1;index<length;index++){var source=arguments[index],keys=keysFunc(source),l=keys.length;for(var i=0;i<l;i++){var key=keys[i];if(!undefinedOnly||obj[key]===void 0)obj[key]=source[key];}}
return obj;};};var baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result;};var property=function(key){return function(obj){return obj==null?void 0:obj[key];};};var MAX_ARRAY_INDEX=Math.pow(2,53)-1;var getLength=property('length');var isArrayLike=function(collection){var length=getLength(collection);return typeof length=='number'&&length>=0&&length<=MAX_ARRAY_INDEX;};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj)){for(i=0,length=obj.length;i<length;i++){iteratee(obj[i],i,obj);}}else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++){iteratee(obj[keys[i]],keys[i],obj);}}
return obj;};_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length);for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj);}
return results;};function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj);}
return memo;}
return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(arguments.length<3){memo=obj[keys?keys[index]:index];index+=dir;}
return iterator(obj,iteratee,memo,keys,index,length);};}
_.reduce=_.foldl=_.inject=createReduce(1);_.reduceRight=_.foldr=createReduce(-1);_.find=_.detect=function(obj,predicate,context){var key;if(isArrayLike(obj)){key=_.findIndex(obj,predicate,context);}else{key=_.findKey(obj,predicate,context);}
if(key!==void 0&&key!==-1)return obj[key];};_.filter=_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list))results.push(value);});return results;};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context);};_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return false;}
return true;};_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return true;}
return false;};_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){if(!isArrayLike(obj))obj=_.values(obj);if(typeof fromIndex!='number'||guard)fromIndex=0;return _.indexOf(obj,item,fromIndex)>=0;};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return func==null?func:func.apply(value,args);});};_.pluck=function(obj,key){return _.map(obj,_.property(key));};_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs));};_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs));};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value>result){result=value;}}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=value;lastComputed=computed;}});}
return result;};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value<result){result=value;}}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=value;lastComputed=computed;}});}
return result;};_.shuffle=function(obj){var set=isArrayLike(obj)?obj:_.values(obj);var length=set.length;var shuffled=Array(length);for(var index=0,rand;index<length;index++){rand=_.random(0,index);if(rand!==index)shuffled[index]=shuffled[rand];shuffled[rand]=set[index];}
return shuffled;};_.sample=function(obj,n,guard){if(n==null||guard){if(!isArrayLike(obj))obj=_.values(obj);return obj[_.random(obj.length-1)];}
return _.shuffle(obj).slice(0,Math.max(0,n));};_.sortBy=function(obj,iteratee,context){iteratee=cb(iteratee,context);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)};}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1;}
return left.index-right.index;}),'value');};var group=function(behavior){return function(obj,iteratee,context){var result={};iteratee=cb(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key);});return result;};};_.groupBy=group(function(result,value,key){if(_.has(result,key))result[key].push(value);else result[key]=[value];});_.indexBy=group(function(result,value,key){result[key]=value;});_.countBy=group(function(result,value,key){if(_.has(result,key))result[key]++;else result[key]=1;});_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(isArrayLike(obj))return _.map(obj,_.identity);return _.values(obj);};_.size=function(obj){if(obj==null)return 0;return isArrayLike(obj)?obj.length:_.keys(obj).length;};_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];_.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value);});return[pass,fail];};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[0];return _.initial(array,array.length-n);};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)));};_.last=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[array.length-1];return _.rest(array,Math.max(0,array.length-n));};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n);};_.compact=function(array){return _.filter(array,_.identity);};var flatten=function(input,shallow,strict,startIndex){var output=[],idx=0;for(var i=startIndex||0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){if(!shallow)value=flatten(value,shallow,strict);var j=0,len=value.length;output.length+=len;while(j<len){output[idx++]=value[j++];}}else if(!strict){output[idx++]=value;}}
return output;};_.flatten=function(array,shallow){return flatten(array,shallow,false);};_.without=function(array){return _.difference(array,slice.call(arguments,1));};_.uniq=_.unique=function(array,isSorted,iteratee,context){if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false;}
if(iteratee!=null)iteratee=cb(iteratee,context);var result=[];var seen=[];for(var i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted){if(!i||seen!==computed)result.push(value);seen=computed;}else if(iteratee){if(!_.contains(seen,computed)){seen.push(computed);result.push(value);}}else if(!_.contains(result,value)){result.push(value);}}
return result;};_.union=function(){return _.uniq(flatten(arguments,true,true));};_.intersection=function(array){var result=[];var argsLength=arguments.length;for(var i=0,length=getLength(array);i<length;i++){var item=array[i];if(_.contains(result,item))continue;for(var j=1;j<argsLength;j++){if(!_.contains(arguments[j],item))break;}
if(j===argsLength)result.push(item);}
return result;};_.difference=function(array){var rest=flatten(arguments,true,true,1);return _.filter(array,function(value){return!_.contains(rest,value);});};_.zip=function(){return _.unzip(arguments);};_.unzip=function(array){var length=array&&_.max(array,getLength).length||0;var result=Array(length);for(var index=0;index<length;index++){result[index]=_.pluck(array,index);}
return result;};_.object=function(list,values){var result={};for(var i=0,length=getLength(list);i<length;i++){if(values){result[list[i]]=values[i];}else{result[list[i][0]]=list[i][1];}}
return result;};function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);var length=getLength(array);var index=dir>0?0:length-1;for(;index>=0&&index<length;index+=dir){if(predicate(array[index],index,array))return index;}
return-1;};}
_.findIndex=createPredicateIndexFinder(1);_.findLastIndex=createPredicateIndexFinder(-1);_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);var value=iteratee(obj);var low=0,high=getLength(array);while(low<high){var mid=Math.floor((low+high)/2);if(iteratee(array[mid])<value)low=mid+1;else high=mid;}
return low;};function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if(typeof idx=='number'){if(dir>0){i=idx>=0?idx:Math.max(idx+length,i);}else{length=idx>=0?Math.min(idx+1,length):idx+length+1;}}else if(sortedIndex&&idx&&length){idx=sortedIndex(array,item);return array[idx]===item?idx:-1;}
if(item!==item){idx=predicateFind(slice.call(array,i,length),_.isNaN);return idx>=0?idx+i:-1;}
for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir){if(array[idx]===item)return idx;}
return-1;};}
_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex);_.lastIndexOf=createIndexFinder(-1,_.findLastIndex);_.range=function(start,stop,step){if(stop==null){stop=start||0;start=0;}
step=step||1;var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step){range[idx]=start;}
return range;};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype);var result=sourceFunc.apply(self,args);if(_.isObject(result))return result;return self;};_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError('Bind must be called on a function');var args=slice.call(arguments,2);var bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)));};return bound;};_.partial=function(func){var boundArgs=slice.call(arguments,1);var bound=function(){var position=0,length=boundArgs.length;var args=Array(length);for(var i=0;i<length;i++){args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i];}
while(position<arguments.length)args.push(arguments[position++]);return executeBound(func,bound,this,this,args);};return bound;};_.bindAll=function(obj){var i,length=arguments.length,key;if(length<=1)throw new Error('bindAll must be passed function names');for(i=1;i<length;i++){key=arguments[i];obj[key]=_.bind(obj[key],obj);}
return obj;};_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache;var address=''+(hasher?hasher.apply(this,arguments):key);if(!_.has(cache,address))cache[address]=func.apply(this,arguments);return cache[address];};memoize.cache={};return memoize;};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args);},wait);};_.defer=_.partial(_.delay,_,1);_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:_.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null;};return function(){var now=_.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null;}
previous=now;result=func.apply(context,args);if(!timeout)context=args=null;}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining);}
return result;};};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;var later=function(){var last=_.now()-timestamp;if(last<wait&&last>=0){timeout=setTimeout(later,wait-last);}else{timeout=null;if(!immediate){result=func.apply(context,args);if(!timeout)context=args=null;}}};return function(){context=this;args=arguments;timestamp=_.now();var callNow=immediate&&!timeout;if(!timeout)timeout=setTimeout(later,wait);if(callNow){result=func.apply(context,args);context=args=null;}
return result;};};_.wrap=function(func,wrapper){return _.partial(wrapper,func);};_.negate=function(predicate){return function(){return!predicate.apply(this,arguments);};};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--)result=args[i].call(this,result);return result;};};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments);}};};_.before=function(times,func){var memo;return function(){if(--times>0){memo=func.apply(this,arguments);}
if(times<=1)func=null;return memo;};};_.once=_.partial(_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable('toString');var nonEnumerableProps=['valueOf','isPrototypeOf','toString','propertyIsEnumerable','hasOwnProperty','toLocaleString'];function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length;var constructor=obj.constructor;var proto=(_.isFunction(constructor)&&constructor.prototype)||ObjProto;var prop='constructor';if(_.has(obj,prop)&&!_.contains(keys,prop))keys.push(prop);while(nonEnumIdx--){prop=nonEnumerableProps[nonEnumIdx];if(prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)){keys.push(prop);}}}
_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)
if(_.has(obj,key))keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys;};_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys;};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]];}
return values;};_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=_.keys(obj),length=keys.length,results={},currentKey;for(var index=0;index<length;index++){currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj);}
return results;};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]];}
return pairs;};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i];}
return result;};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key);}
return names.sort();};_.extend=createAssigner(_.allKeys);_.extendOwn=_.assign=createAssigner(_.keys);_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);var keys=_.keys(obj),key;for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(predicate(obj[key],key,obj))return key;}};_.pick=function(object,oiteratee,context){var result={},obj=object,iteratee,keys;if(obj==null)return result;if(_.isFunction(oiteratee)){keys=_.allKeys(obj);iteratee=optimizeCb(oiteratee,context);}else{keys=flatten(arguments,false,false,1);iteratee=function(value,key,obj){return key in obj;};obj=Object(obj);}
for(var i=0,length=keys.length;i<length;i++){var key=keys[i];var value=obj[key];if(iteratee(value,key,obj))result[key]=value;}
return result;};_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee)){iteratee=_.negate(iteratee);}else{var keys=_.map(flatten(arguments,false,false,1),String);iteratee=function(value,key){return!_.contains(keys,key);};}
return _.pick(obj,iteratee,context);};_.defaults=createAssigner(_.allKeys,true);_.create=function(prototype,props){var result=baseCreate(prototype);if(props)_.extendOwn(result,props);return result;};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj);};_.tap=function(obj,interceptor){interceptor(obj);return obj;};_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(object==null)return!length;var obj=Object(object);for(var i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return false;}
return true;};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!==toString.call(b))return false;switch(className){case'[object RegExp]':case'[object String]':return''+a===''+b;case'[object Number]':if(+a!==+a)return+b!==+b;return+a===0?1/+a===1/b:+a===+b;case'[object Date]':case'[object Boolean]':return+a===+b;}
var areArrays=className==='[object Array]';if(!areArrays){if(typeof a!='object'||typeof b!='object')return false;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&('constructor'in a&&'constructor'in b)){return false;}}
aStack=aStack||[];bStack=bStack||[];var length=aStack.length;while(length--){if(aStack[length]===a)return bStack[length]===b;}
aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length)return false;while(length--){if(!eq(a[length],b[length],aStack,bStack))return false;}}else{var keys=_.keys(a),key;length=keys.length;if(_.keys(b).length!==length)return false;while(length--){key=keys[length];if(!(_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))return false;}}
aStack.pop();bStack.pop();return true;};_.isEqual=function(a,b){return eq(a,b);};_.isEmpty=function(obj){if(obj==null)return true;if(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj)))return obj.length===0;return _.keys(obj).length===0;};_.isElement=function(obj){return!!(obj&&obj.nodeType===1);};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==='[object Array]';};_.isObject=function(obj){var type=typeof obj;return type==='function'||type==='object'&&!!obj;};_.each(['Arguments','Function','String','Number','Date','RegExp','Error'],function(name){_['is'+name]=function(obj){return toString.call(obj)==='[object '+name+']';};});if(!_.isArguments(arguments)){_.isArguments=function(obj){return _.has(obj,'callee');};}
if(typeof / . /!='function'&&typeof Int8Array!='object'){_.isFunction=function(obj){return typeof obj=='function'||false;};}
_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj));};_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj;};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==='[object Boolean]';};_.isNull=function(obj){return obj===null;};_.isUndefined=function(obj){return obj===void 0;};_.has=function(obj,key){return obj!=null&&hasOwnProperty.call(obj,key);};_.noConflict=function(){root._=previousUnderscore;return this;};_.identity=function(value){return value;};_.constant=function(value){return function(){return value;};};_.noop=function(){};_.property=property;_.propertyOf=function(obj){return obj==null?function(){}:function(key){return obj[key];};};_.matcher=_.matches=function(attrs){attrs=_.extendOwn({},attrs);return function(obj){return _.isMatch(obj,attrs);};};_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum;};_.random=function(min,max){if(max==null){max=min;min=0;}
return min+Math.floor(Math.random()*(max-min+1));};_.now=Date.now||function(){return new Date().getTime();};var escapeMap={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#x27;','`':'&#x60;'};var unescapeMap=_.invert(escapeMap);var createEscaper=function(map){var escaper=function(match){return map[match];};var source='(?:'+_.keys(map).join('|')+')';var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,'g');return function(string){string=string==null?'':''+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string;};};_.escape=createEscaper(escapeMap);_.unescape=createEscaper(unescapeMap);_.result=function(object,property,fallback){var value=object==null?void 0:object[property];if(value===void 0){value=fallback;}
return _.isFunction(value)?value.call(object):value;};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+'';return prefix?prefix+id:id;};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'",'\\':'\\','\r':'r','\n':'n','\u2028':'u2028','\u2029':'u2029'};var escaper=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function(match){return'\\'+escapes[match];};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings)settings=oldSettings;settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join('|')+'|jQuery','g');var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,escapeChar);index=offset+match.length;if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'";}else if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'";}else if(evaluate){source+="';\n"+evaluate+"\n__p+='";}
return match;});source+="';\n";if(!settings.variable)source='with(obj||{}){\n'+source+'}\n';source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+
source+'return __p;\n';try{var render=new Function(settings.variable||'obj','_',source);}catch(e){e.source=source;throw e;}
var template=function(data){return render.call(this,data,_);};var argument=settings.variable||'obj';template.source='function('+argument+'){\n'+source+'}';return template;};_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance;};var result=function(instance,obj){return instance._chain?_(obj).chain():obj;};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result(this,func.apply(_,args));};});};_.mixin(_);_.each(['pop','push','reverse','shift','sort','splice','unshift'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==='shift'||name==='splice')&&obj.length===0)delete obj[0];return result(this,obj);};});_.each(['concat','join','slice'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments));};});_.prototype.value=function(){return this._wrapped;};_.prototype.valueOf=_.prototype.toJSON=_.prototype.value;_.prototype.toString=function(){return''+this._wrapped;};if(typeof define==='function'&&define.amd){define('underscore',[],function(){return _;});}}.call(this));},{}],2:[function(require,module,exports){'use strict';var Dropdown=function(){var open=false;return{init:function(){this.addClickHandlers();},addClickHandlers:function(){var _this=this;jQuery('.i-dropdown__trigger').mouseenter(function(){event.preventDefault();_this.toggle(jQuery(this),jQuery(this).find('.i-dropdown__list'));});jQuery('.i-dropdown__trigger').mouseout(function(){event.preventDefault();_this.toggle(jQuery(this),jQuery(this).find('.i-dropdown__list'));});},toggle:function(trigger,list){open=!open;trigger.toggleClass('b-header__main-navigation-link--dropdown-active');list.toggle();}}}();Dropdown.init();module.exports=Dropdown;},{}],3:[function(require,module,exports){'use strict';var MainNavigation=function(){return{init:function(){this.addResizeHandlers();},addResizeHandlers:function(){jQuery(window).resize(function(){var overlaps=function(){if(jQuery('.i-side-navigation').length>0){var sideNavigationPositionLeft=jQuery('.i-side-navigation').position().left,navigationPositionRight=jQuery('.i-navigation').position().left+jQuery('.i-navigation').outerWidth(true);return(sideNavigationPositionLeft<=navigationPositionRight);}}();if(overlaps){var navigationItems=jQuery('.i-navigation').children('a:not(:last-child)');var lastItem=jQuery(navigationItems[navigationItems.length-1]);var lastItemClone=lastItem.clone(true,true).removeClass('b-header__main-navigation-link').addClass('b-header__main-navigation-dropdown-link');jQuery('.i-main-navigation-dropdown').prepend(lastItemClone.wrap('<li />').parent());lastItem.remove();}else{if(jQuery('.i-navigation').outerWidth(true)<=400){var navigationItems=jQuery('.i-main-navigation-dropdown').children('li');var firstItem=jQuery(navigationItems[0]);var firstItemClone=firstItem.find('a').clone(true,true).removeClass('b-header__main-navigation-dropdown-link').addClass('b-header__main-navigation-link');firstItem.remove();jQuery('.i-navigation .i-dropdown__trigger').before(firstItemClone);}}});}};}();MainNavigation.init();module.exports=MainNavigation;},{}],4:[function(require,module,exports){'use strict';var ChallengeTimeline=function(){return{init:function(){this.addClickHandlers();if(!Modernizr.flexbox){this.setSizes();}},addClickHandlers:function(){var _this=this;jQuery('.i-phase').click(function(event){event.preventDefault();if((!jQuery(this).hasClass('i-phase--disabled'))&&(!jQuery(this).hasClass('b-single-challenge__timeline-section--active'))){jQuery('.i-phase--active').removeClass('b-single-challenge__timeline-section--active i-phase--active');jQuery(this).addClass('b-single-challenge__timeline-section--active i-phase--active');jQuery(".b-single-challenge__timeline-section-info .b-excerpt").hide();console.log("timeline panel click");jQuery(this).find(".b-excerpt").delay(500).slideDown(500);_this.loadIdeas(jQuery(this).data('category-id'),jQuery(this).data('phase-id'));jQuery('#selectedPhase').val(jQuery(this).data('phase-id'));if(!Modernizr.flexbox){_this.setSizes();}}});},loadIdeas:function(category_id,phase_id){jQuery.ajax('/category/'+category_id+'?sortBy=newest&fullRight=1&forPhase='+phase_id,{beforeSend:function(){jQuery('.i-ideas-list').css('opacity',0.5);},success:function(data){jQuery('.i-ideas-list').css('opacity',1);jQuery('#main-challenge-container').html(data);tipInit();}});},setSizes:function(){var phase_count=jQuery('.i-phase').length;var phase_width=100/phase_count;jQuery('.i-phase').css('width',(phase_width-phase_count)+'%');jQuery('.i-phase--active').css('width',((phase_width+(phase_count*(phase_count-1)))-1)+'%');}};}();ChallengeTimeline.init();module.exports=ChallengeTimeline;},{}],5:[function(require,module,exports){'use strict';var SearchBox=function(){return{init:function(){this.addClickHandlers();},addClickHandlers:function(){},submitForm:function(){console.log('submit test');}};}();SearchBox.init();module.exports=SearchBox;},{}],6:[function(require,module,exports){'use strict';var SidebarSection=function(){return{init:function(){this.addExpandToggleHandlers();},addExpandToggleHandlers:function(){jQuery('.i-sidebar__section-expand-button').click(function(event){event.stopImmediatePropagation();event.stopPropagation();event.preventDefault();jQuery(this).parent().next().toggleClass('b-collapsed i-collapsed').slideToggle();jQuery(this).toggleClass('b-icon--caret-down').toggleClass('b-icon--caret-up');});}};}();SidebarSection.init();module.exports=SidebarSection;},{}],7:[function(require,module,exports){'use strict';var _=require('underscore');var SearchBox=require('./components/search/SearchBox'),SidebarSection=require('./components/sidebar/SidebarSection'),MainNavigation=require('./components/UI/navigation/MainNavigation'),Dropdown=require('./components/UI/core/interactivity/Dropdown'),ChallengeTimeline=require('./components/challenges/ChallengeTimeline');},{"./components/UI/core/interactivity/Dropdown":2,"./components/UI/navigation/MainNavigation":3,"./components/challenges/ChallengeTimeline":4,"./components/search/SearchBox":5,"./components/sidebar/SidebarSection":6,"underscore":1}]},{},[7]);(function(jQuery,undf){jQuery.MixItUp=function(){var self=this;self._execAction('_constructor',0);jQuery.extend(self,{selectors:{target:'.mix',filter:'.filter',sort:'.sort'},animation:{enable:true,effects:'fade scale',duration:600,easing:'ease',perspectiveDistance:'3000',perspectiveOrigin:'50% 50%',queue:true,queueLimit:1,animateChangeLayout:false,animateResizeContainer:true,animateResizeTargets:false,staggerSequence:false,reverseOut:false},callbacks:{onMixLoad:false,onMixStart:false,onMixBusy:false,onMixEnd:false,onMixFail:false,_user:false},controls:{enable:true,live:false,toggleFilterButtons:false,toggleLogic:'or',activeClass:'active'},layout:{display:'inline-block',containerClass:'',containerClassFail:'fail'},load:{filter:'all',sort:false},_$body:null,_$container:null,_$targets:null,_$parent:null,_$sortButtons:null,_$filterButtons:null,_suckMode:false,_mixing:false,_sorting:false,_clicking:false,_loading:true,_changingLayout:false,_changingClass:false,_changingDisplay:false,_origOrder:[],_startOrder:[],_newOrder:[],_activeFilter:null,_toggleArray:[],_toggleString:'',_activeSort:'default:asc',_newSort:null,_startHeight:null,_newHeight:null,_incPadding:true,_newDisplay:null,_newClass:null,_targetsBound:0,_targetsDone:0,_queue:[],_$show:jQuery(),_$hide:jQuery()});self._execAction('_constructor',1);};jQuery.MixItUp.prototype={constructor:jQuery.MixItUp,_instances:{},_handled:{_filter:{},_sort:{}},_bound:{_filter:{},_sort:{}},_actions:{},_filters:{},extend:function(extension){for(var key in extension){jQuery.MixItUp.prototype[key]=extension[key];}},addAction:function(hook,name,func,priority){jQuery.MixItUp.prototype._addHook('_actions',hook,name,func,priority);},addFilter:function(hook,name,func,priority){jQuery.MixItUp.prototype._addHook('_filters',hook,name,func,priority);},_addHook:function(type,hook,name,func,priority){var collection=jQuery.MixItUp.prototype[type],obj={};priority=(priority===1||priority==='post')?'post':'pre';obj[hook]={};obj[hook][priority]={};obj[hook][priority][name]=func;jQuery.extend(true,collection,obj);},_init:function(domNode,config){var self=this;self._execAction('_init',0,arguments);config&&jQuery.extend(true,self,config);self._$body=jQuery('body');self._domNode=domNode;self._$container=jQuery(domNode);self._$container.addClass(self.layout.containerClass);self._id=domNode.id;self._platformDetect();self._brake=self._getPrefixedCSS('transition','none');self._refresh(true);self._$parent=self._$targets.parent().length?self._$targets.parent():self._$container;if(self.load.sort){self._newSort=self._parseSort(self.load.sort);self._newSortString=self.load.sort;self._activeSort=self.load.sort;self._sort();self._printSort();}
self._activeFilter=self.load.filter==='all'?self.selectors.target:self.load.filter==='none'?'':self.load.filter;self.controls.enable&&self._bindHandlers();if(self.controls.toggleFilterButtons){self._buildToggleArray();for(var i=0;i<self._toggleArray.length;i++){self._updateControls({filter:self._toggleArray[i],sort:self._activeSort},true);};}else if(self.controls.enable){self._updateControls({filter:self._activeFilter,sort:self._activeSort});}
self._filter();self._init=true;self._$container.data('mixItUp',self);self._execAction('_init',1,arguments);self._buildState();self._$targets.css(self._brake);self._goMix(self.animation.enable);},_platformDetect:function(){var self=this,vendorsTrans=['Webkit','Moz','O','ms'],vendorsRAF=['webkit','moz'],chrome=window.navigator.appVersion.match(/Chrome\/(\d+)\./)||false,ff=typeof InstallTrigger!=='undefined',prefix=function(el){for(var i=0;i<vendorsTrans.length;i++){if(vendorsTrans[i]+'Transition'in el.style){return{prefix:'-'+vendorsTrans[i].toLowerCase()+'-',vendor:vendorsTrans[i]};};};return'transition'in el.style?'':false;},transPrefix=prefix(self._domNode);self._execAction('_platformDetect',0);self._chrome=chrome?parseInt(chrome[1],10):false;self._ff=ff?parseInt(window.navigator.userAgent.match(/rv:([^)]+)\)/)[1]):false;self._prefix=transPrefix.prefix;self._vendor=transPrefix.vendor;self._suckMode=window.atob&&self._prefix?false:true;self._suckMode&&(self.animation.enable=false);(self._ff&&self._ff<=4)&&(self.animation.enable=false);for(var x=0;x<vendorsRAF.length&&!window.requestAnimationFrame;x++){window.requestAnimationFrame=window[vendorsRAF[x]+'RequestAnimationFrame'];}
if(typeof Object.getPrototypeOf!=='function'){if(typeof'test'.__proto__==='object'){Object.getPrototypeOf=function(object){return object.__proto__;};}else{Object.getPrototypeOf=function(object){return object.constructor.prototype;};}}
if(self._domNode.nextElementSibling===undf){Object.defineProperty(Element.prototype,'nextElementSibling',{get:function(){var el=this.nextSibling;while(el){if(el.nodeType===1){return el;}
el=el.nextSibling;}
return null;}});}
self._execAction('_platformDetect',1);},_refresh:function(init,force){var self=this;self._execAction('_refresh',0,arguments);self._$targets=self._$container.find(self.selectors.target);for(var i=0;i<self._$targets.length;i++){var target=self._$targets[i];if(target.dataset===undf||force){target.dataset={};for(var j=0;j<target.attributes.length;j++){var attr=target.attributes[j],name=attr.name,val=attr.value;if(name.indexOf('data-')>-1){var dataName=self._helpers._camelCase(name.substring(5,name.length));target.dataset[dataName]=val;}}}
if(target.mixParent===undf){target.mixParent=self._id;}}
if((self._$targets.length&&init)||(!self._origOrder.length&&self._$targets.length)){self._origOrder=[];for(var i=0;i<self._$targets.length;i++){var target=self._$targets[i];self._origOrder.push(target);}}
self._execAction('_refresh',1,arguments);},_bindHandlers:function(){var self=this,filters=jQuery.MixItUp.prototype._bound._filter,sorts=jQuery.MixItUp.prototype._bound._sort;self._execAction('_bindHandlers',0);if(self.controls.live){self._$body.on('click.mixItUp.'+self._id,self.selectors.sort,function(){self._processClick(jQuery(this),'sort');}).on('click.mixItUp.'+self._id,self.selectors.filter,function(){self._processClick(jQuery(this),'filter');});}else{self._$sortButtons=jQuery(self.selectors.sort);self._$filterButtons=jQuery(self.selectors.filter);self._$sortButtons.on('click.mixItUp.'+self._id,function(){self._processClick(jQuery(this),'sort');});self._$filterButtons.on('click.mixItUp.'+self._id,function(){self._processClick(jQuery(this),'filter');});}
filters[self.selectors.filter]=(filters[self.selectors.filter]===undf)?1:filters[self.selectors.filter]+1;sorts[self.selectors.sort]=(sorts[self.selectors.sort]===undf)?1:sorts[self.selectors.sort]+1;self._execAction('_bindHandlers',1);},_processClick:function($button,type){var self=this,trackClick=function($button,type,off){var proto=jQuery.MixItUp.prototype;proto._handled['_'+type][self.selectors[type]]=(proto._handled['_'+type][self.selectors[type]]===undf)?1:proto._handled['_'+type][self.selectors[type]]+1;if(proto._handled['_'+type][self.selectors[type]]===proto._bound['_'+type][self.selectors[type]]){$button[(off?'remove':'add')+'Class'](self.controls.activeClass);delete proto._handled['_'+type][self.selectors[type]];}};self._execAction('_processClick',0,arguments);if(!self._mixing||(self.animation.queue&&self._queue.length<self.animation.queueLimit)){self._clicking=true;if(type==='sort'){var sort=$button.attr('data-sort');if(!$button.hasClass(self.controls.activeClass)||sort.indexOf('random')>-1){jQuery(self.selectors.sort).removeClass(self.controls.activeClass);trackClick($button,type);self.sort(sort);}}
if(type==='filter'){var filter=$button.attr('data-filter'),ndx,seperator=self.controls.toggleLogic==='or'?',':'';if(!self.controls.toggleFilterButtons){if(!$button.hasClass(self.controls.activeClass)){jQuery(self.selectors.filter).removeClass(self.controls.activeClass);trackClick($button,type);self.filter(filter);}}else{self._buildToggleArray();if(!$button.hasClass(self.controls.activeClass)){trackClick($button,type);self._toggleArray.push(filter);}else{trackClick($button,type,true);ndx=self._toggleArray.indexOf(filter);self._toggleArray.splice(ndx,1);}
self._toggleArray=jQuery.grep(self._toggleArray,function(n){return(n);});self._toggleString=self._toggleArray.join(seperator);self.filter(self._toggleString);}}
self._execAction('_processClick',1,arguments);}else{if(typeof self.callbacks.onMixBusy==='function'){self.callbacks.onMixBusy.call(self._domNode,self._state,self);}
self._execAction('_processClickBusy',1,arguments);}},_buildToggleArray:function(){var self=this,activeFilter=self._activeFilter.replace(/\s/g,'');self._execAction('_buildToggleArray',0,arguments);if(self.controls.toggleLogic==='or'){self._toggleArray=activeFilter.split(',');}else{self._toggleArray=activeFilter.split('.');!self._toggleArray[0]&&self._toggleArray.shift();for(var i=0,filter;filter=self._toggleArray[i];i++){self._toggleArray[i]='.'+filter;}}
self._execAction('_buildToggleArray',1,arguments);},_updateControls:function(command,multi){var self=this,output={filter:command.filter,sort:command.sort},update=function($el,filter){try{(multi&&type==='filter'&&!(output.filter==='none'||output.filter===''))?$el.filter(filter).addClass(self.controls.activeClass):$el.removeClass(self.controls.activeClass).filter(filter).addClass(self.controls.activeClass);}catch(e){}},type='filter',$el=null;self._execAction('_updateControls',0,arguments);(command.filter===undf)&&(output.filter=self._activeFilter);(command.sort===undf)&&(output.sort=self._activeSort);(output.filter===self.selectors.target)&&(output.filter='all');for(var i=0;i<2;i++){$el=self.controls.live?jQuery(self.selectors[type]):self['_$'+type+'Buttons'];$el&&update($el,'[data-'+type+'="'+output[type]+'"]');type='sort';}
self._execAction('_updateControls',1,arguments);},_filter:function(){var self=this;self._execAction('_filter',0);for(var i=0;i<self._$targets.length;i++){var $target=jQuery(self._$targets[i]);if($target.is(self._activeFilter)){self._$show=self._$show.add($target);}else{self._$hide=self._$hide.add($target);}}
self._execAction('_filter',1);},_sort:function(){var self=this,arrayShuffle=function(oldArray){var newArray=oldArray.slice(),len=newArray.length,i=len;while(i--){var p=parseInt(Math.random()*len);var t=newArray[i];newArray[i]=newArray[p];newArray[p]=t;};return newArray;};self._execAction('_sort',0);self._startOrder=[];for(var i=0;i<self._$targets.length;i++){var target=self._$targets[i];self._startOrder.push(target);}
switch(self._newSort[0].sortBy){case'default':self._newOrder=self._origOrder;break;case'random':self._newOrder=arrayShuffle(self._startOrder);break;case'custom':self._newOrder=self._newSort[0].order;break;default:self._newOrder=self._startOrder.concat().sort(function(a,b){return self._compare(a,b);});}
self._execAction('_sort',1);},_compare:function(a,b,depth){depth=depth?depth:0;var self=this,order=self._newSort[depth].order,getData=function(el){return el.dataset[self._newSort[depth].sortBy]||0;},attrA=isNaN(getData(a)*1)?getData(a).toLowerCase():getData(a)*1,attrB=isNaN(getData(b)*1)?getData(b).toLowerCase():getData(b)*1;if(attrA<attrB)
return order==='asc'?-1:1;if(attrA>attrB)
return order==='asc'?1:-1;if(attrA===attrB&&self._newSort.length>depth+1)
return self._compare(a,b,depth+1);return 0;},_printSort:function(reset){var self=this,order=reset?self._startOrder:self._newOrder,targets=self._$parent[0].querySelectorAll(self.selectors.target),nextSibling=targets.length?targets[targets.length-1].nextElementSibling:null,frag=document.createDocumentFragment();self._execAction('_printSort',0,arguments);for(var i=0;i<targets.length;i++){var target=targets[i],whiteSpace=target.nextSibling;if(target.style.position==='absolute')continue;if(whiteSpace&&whiteSpace.nodeName==='#text'){self._$parent[0].removeChild(whiteSpace);}
self._$parent[0].removeChild(target);}
for(var i=0;i<order.length;i++){var el=order[i];if(self._newSort[0].sortBy==='default'&&self._newSort[0].order==='desc'&&!reset){var firstChild=frag.firstChild;frag.insertBefore(el,firstChild);frag.insertBefore(document.createTextNode(' '),el);}else{frag.appendChild(el);frag.appendChild(document.createTextNode(' '));}}
nextSibling?self._$parent[0].insertBefore(frag,nextSibling):self._$parent[0].appendChild(frag);self._execAction('_printSort',1,arguments);},_parseSort:function(sortString){var self=this,rules=typeof sortString==='string'?sortString.split(' '):[sortString],newSort=[];for(var i=0;i<rules.length;i++){var rule=typeof sortString==='string'?rules[i].split(':'):['custom',rules[i]],ruleObj={sortBy:self._helpers._camelCase(rule[0]),order:rule[1]||'asc'};newSort.push(ruleObj);if(ruleObj.sortBy==='default'||ruleObj.sortBy==='random')break;}
return self._execFilter('_parseSort',newSort,arguments);},_parseEffects:function(){var self=this,effects={opacity:'',transformIn:'',transformOut:'',filter:''},parse=function(effect,extract,reverse){if(self.animation.effects.indexOf(effect)>-1){if(extract){var propIndex=self.animation.effects.indexOf(effect+'(');if(propIndex>-1){var str=self.animation.effects.substring(propIndex),match=/\(([^)]+)\)/.exec(str),val=match[1];return{val:val};}}
return true;}else{return false;}},negate=function(value,invert){if(invert){return value.charAt(0)==='-'?value.substr(1,value.length):'-'+value;}else{return value;}},buildTransform=function(key,invert){var transforms=[['scale','.01'],['translateX','20px'],['translateY','20px'],['translateZ','20px'],['rotateX','90deg'],['rotateY','90deg'],['rotateZ','180deg'],];for(var i=0;i<transforms.length;i++){var prop=transforms[i][0],def=transforms[i][1],inverted=invert&&prop!=='scale';effects[key]+=parse(prop)?prop+'('+negate(parse(prop,true).val||def,inverted)+') ':'';}};effects.opacity=parse('fade')?parse('fade',true).val||'0':'1';buildTransform('transformIn');self.animation.reverseOut?buildTransform('transformOut',true):(effects.transformOut=effects.transformIn);effects.transition={};effects.transition=self._getPrefixedCSS('transition','all '+self.animation.duration+'ms '+self.animation.easing+', opacity '+self.animation.duration+'ms linear');self.animation.stagger=parse('stagger')?true:false;self.animation.staggerDuration=parseInt(parse('stagger')?(parse('stagger',true).val?parse('stagger',true).val:100):100);return self._execFilter('_parseEffects',effects);},_buildState:function(future){var self=this,state={};self._execAction('_buildState',0);state={activeFilter:self._activeFilter===''?'none':self._activeFilter,activeSort:future&&self._newSortString?self._newSortString:self._activeSort,fail:!self._$show.length&&self._activeFilter!=='',$targets:self._$targets,$show:self._$show,$hide:self._$hide,totalTargets:self._$targets.length,totalShow:self._$show.length,totalHide:self._$hide.length,display:future&&self._newDisplay?self._newDisplay:self.layout.display};if(future){return self._execFilter('_buildState',state);}else{self._state=state;self._execAction('_buildState',1);}},_goMix:function(animate){var self=this,phase1=function(){if(self._chrome&&(self._chrome===31)){chromeFix(self._$parent[0]);}
self._setInter();phase2();},phase2=function(){var scrollTop=window.pageYOffset,scrollLeft=window.pageXOffset,docHeight=document.documentElement.scrollHeight;self._getInterMixData();self._setFinal();self._getFinalMixData();(window.pageYOffset!==scrollTop)&&window.scrollTo(scrollLeft,scrollTop);self._prepTargets();if(window.requestAnimationFrame){requestAnimationFrame(phase3);}else{setTimeout(function(){phase3();},20);}},phase3=function(){self._animateTargets();if(self._targetsBound===0){self._cleanUp();}},chromeFix=function(grid){var parent=grid.parentElement,placeholder=document.createElement('div'),frag=document.createDocumentFragment();parent.insertBefore(placeholder,grid);frag.appendChild(grid);parent.replaceChild(grid,placeholder);},futureState=self._buildState(true);self._execAction('_goMix',0,arguments);!self.animation.duration&&(animate=false);self._mixing=true;self._$container.removeClass(self.layout.containerClassFail);if(typeof self.callbacks.onMixStart==='function'){self.callbacks.onMixStart.call(self._domNode,self._state,futureState,self);}
self._$container.trigger('mixStart',[self._state,futureState,self]);self._getOrigMixData();if(animate&&!self._suckMode){window.requestAnimationFrame?requestAnimationFrame(phase1):phase1();}else{self._cleanUp();}
self._execAction('_goMix',1,arguments);},_getTargetData:function(el,stage){var self=this,elStyle;el.dataset[stage+'PosX']=el.offsetLeft;el.dataset[stage+'PosY']=el.offsetTop;if(self.animation.animateResizeTargets){elStyle=!self._suckMode?window.getComputedStyle(el):{marginBottom:'',marginRight:''};el.dataset[stage+'MarginBottom']=parseInt(elStyle.marginBottom);el.dataset[stage+'MarginRight']=parseInt(elStyle.marginRight);el.dataset[stage+'Width']=el.offsetWidth;el.dataset[stage+'Height']=el.offsetHeight;}},_getOrigMixData:function(){var self=this,parentStyle=!self._suckMode?window.getComputedStyle(self._$parent[0]):{boxSizing:''},parentBS=parentStyle.boxSizing||parentStyle[self._vendor+'BoxSizing'];self._incPadding=(parentBS==='border-box');self._execAction('_getOrigMixData',0);!self._suckMode&&(self.effects=self._parseEffects());self._$toHide=self._$hide.filter(':visible');self._$toShow=self._$show.filter(':hidden');self._$pre=self._$targets.filter(':visible');self._startHeight=self._incPadding?self._$parent.outerHeight():self._$parent.height();for(var i=0;i<self._$pre.length;i++){var el=self._$pre[i];self._getTargetData(el,'orig');}
self._execAction('_getOrigMixData',1);},_setInter:function(){var self=this;self._execAction('_setInter',0);if(self._changingLayout&&self.animation.animateChangeLayout){self._$toShow.css('display',self._newDisplay);if(self._changingClass){self._$container.removeClass(self.layout.containerClass).addClass(self._newClass);}}else{self._$toShow.css('display',self.layout.display);}
self._execAction('_setInter',1);},_getInterMixData:function(){var self=this;self._execAction('_getInterMixData',0);for(var i=0;i<self._$toShow.length;i++){var el=self._$toShow[i];self._getTargetData(el,'inter');}
for(var i=0;i<self._$pre.length;i++){var el=self._$pre[i];self._getTargetData(el,'inter');}
self._execAction('_getInterMixData',1);},_setFinal:function(){var self=this;self._execAction('_setFinal',0);self._sorting&&self._printSort();self._$toHide.removeStyle('display');if(self._changingLayout&&self.animation.animateChangeLayout){self._$pre.css('display',self._newDisplay);}
self._execAction('_setFinal',1);},_getFinalMixData:function(){var self=this;self._execAction('_getFinalMixData',0);for(var i=0;i<self._$toShow.length;i++){var el=self._$toShow[i];self._getTargetData(el,'final');}
for(var i=0;i<self._$pre.length;i++){var el=self._$pre[i];self._getTargetData(el,'final');}
self._newHeight=self._incPadding?self._$parent.outerHeight():self._$parent.height();self._sorting&&self._printSort(true);self._$toShow.removeStyle('display');self._$pre.css('display',self.layout.display);if(self._changingClass&&self.animation.animateChangeLayout){self._$container.removeClass(self._newClass).addClass(self.layout.containerClass);}
self._execAction('_getFinalMixData',1);},_prepTargets:function(){var self=this,transformCSS={_in:self._getPrefixedCSS('transform',self.effects.transformIn),_out:self._getPrefixedCSS('transform',self.effects.transformOut)};self._execAction('_prepTargets',0);if(self.animation.animateResizeContainer){self._$parent.css('height',self._startHeight+'px');}
for(var i=0;i<self._$toShow.length;i++){var el=self._$toShow[i],$el=jQuery(el);el.style.opacity=self.effects.opacity;el.style.display=(self._changingLayout&&self.animation.animateChangeLayout)?self._newDisplay:self.layout.display;$el.css(transformCSS._in);if(self.animation.animateResizeTargets){el.style.width=el.dataset.finalWidth+'px';el.style.height=el.dataset.finalHeight+'px';el.style.marginRight=-(el.dataset.finalWidth-el.dataset.interWidth)+(el.dataset.finalMarginRight*1)+'px';el.style.marginBottom=-(el.dataset.finalHeight-el.dataset.interHeight)+(el.dataset.finalMarginBottom*1)+'px';}}
for(var i=0;i<self._$pre.length;i++){var el=self._$pre[i],$el=jQuery(el),translate={x:el.dataset.origPosX-el.dataset.interPosX,y:el.dataset.origPosY-el.dataset.interPosY},transformCSS=self._getPrefixedCSS('transform','translate('+translate.x+'px,'+translate.y+'px)');$el.css(transformCSS);if(self.animation.animateResizeTargets){el.style.width=el.dataset.origWidth+'px';el.style.height=el.dataset.origHeight+'px';if(el.dataset.origWidth-el.dataset.finalWidth){el.style.marginRight=-(el.dataset.origWidth-el.dataset.interWidth)+(el.dataset.origMarginRight*1)+'px';}
if(el.dataset.origHeight-el.dataset.finalHeight){el.style.marginBottom=-(el.dataset.origHeight-el.dataset.interHeight)+(el.dataset.origMarginBottom*1)+'px';}}}
self._execAction('_prepTargets',1);},_animateTargets:function(){var self=this;self._execAction('_animateTargets',0);self._targetsDone=0;self._targetsBound=0;self._$parent.css(self._getPrefixedCSS('perspective',self.animation.perspectiveDistance+'px')).css(self._getPrefixedCSS('perspective-origin',self.animation.perspectiveOrigin));if(self.animation.animateResizeContainer){self._$parent.css(self._getPrefixedCSS('transition','height '+self.animation.duration+'ms ease')).css('height',self._newHeight+'px');}
for(var i=0;i<self._$toShow.length;i++){var el=self._$toShow[i],$el=jQuery(el),translate={x:el.dataset.finalPosX-el.dataset.interPosX,y:el.dataset.finalPosY-el.dataset.interPosY},delay=self._getDelay(i),toShowCSS={};el.style.opacity='';for(var j=0;j<2;j++){var a=j===0?a=self._prefix:'';if(self._ff&&self._ff<=20){toShowCSS[a+'transition-property']='all';toShowCSS[a+'transition-timing-function']=self.animation.easing+'ms';toShowCSS[a+'transition-duration']=self.animation.duration+'ms';}
toShowCSS[a+'transition-delay']=delay+'ms';toShowCSS[a+'transform']='translate('+translate.x+'px,'+translate.y+'px)';}
if(self.effects.transform||self.effects.opacity){self._bindTargetDone($el);}
(self._ff&&self._ff<=20)?$el.css(toShowCSS):$el.css(self.effects.transition).css(toShowCSS);}
for(var i=0;i<self._$pre.length;i++){var el=self._$pre[i],$el=jQuery(el),translate={x:el.dataset.finalPosX-el.dataset.interPosX,y:el.dataset.finalPosY-el.dataset.interPosY},delay=self._getDelay(i);if(!(el.dataset.finalPosX===el.dataset.origPosX&&el.dataset.finalPosY===el.dataset.origPosY)){self._bindTargetDone($el);}
$el.css(self._getPrefixedCSS('transition','all '+self.animation.duration+'ms '+self.animation.easing+' '+delay+'ms'));$el.css(self._getPrefixedCSS('transform','translate('+translate.x+'px,'+translate.y+'px)'));if(self.animation.animateResizeTargets){if(el.dataset.origWidth-el.dataset.finalWidth&&el.dataset.finalWidth*1){el.style.width=el.dataset.finalWidth+'px';el.style.marginRight=-(el.dataset.finalWidth-el.dataset.interWidth)+(el.dataset.finalMarginRight*1)+'px';}
if(el.dataset.origHeight-el.dataset.finalHeight&&el.dataset.finalHeight*1){el.style.height=el.dataset.finalHeight+'px';el.style.marginBottom=-(el.dataset.finalHeight-el.dataset.interHeight)+(el.dataset.finalMarginBottom*1)+'px';}}}
if(self._changingClass){self._$container.removeClass(self.layout.containerClass).addClass(self._newClass);}
for(var i=0;i<self._$toHide.length;i++){var el=self._$toHide[i],$el=jQuery(el),delay=self._getDelay(i),toHideCSS={};for(var j=0;j<2;j++){var a=j===0?a=self._prefix:'';toHideCSS[a+'transition-delay']=delay+'ms';toHideCSS[a+'transform']=self.effects.transformOut;toHideCSS.opacity=self.effects.opacity;}
$el.css(self.effects.transition).css(toHideCSS);if(self.effects.transform||self.effects.opacity){self._bindTargetDone($el);};}
self._execAction('_animateTargets',1);},_bindTargetDone:function($el){var self=this,el=$el[0];self._execAction('_bindTargetDone',0,arguments);if(!el.dataset.bound){el.dataset.bound=true;self._targetsBound++;$el.on('webkitTransitionEnd.mixItUp transitionend.mixItUp',function(e){if((e.originalEvent.propertyName.indexOf('transform')>-1||e.originalEvent.propertyName.indexOf('opacity')>-1)&&jQuery(e.originalEvent.target).is(self.selectors.target)){$el.off('.mixItUp');delete el.dataset.bound;self._targetDone();}});}
self._execAction('_bindTargetDone',1,arguments);},_targetDone:function(){var self=this;self._execAction('_targetDone',0);self._targetsDone++;(self._targetsDone===self._targetsBound)&&self._cleanUp();self._execAction('_targetDone',1);},_cleanUp:function(){var self=this,targetStyles=self.animation.animateResizeTargets?'transform opacity width height margin-bottom margin-right':'transform opacity';unBrake=function(){self._$targets.removeStyle('transition',self._prefix);};self._execAction('_cleanUp',0);!self._changingLayout?self._$show.css('display',self.layout.display):self._$show.css('display',self._newDisplay);self._$targets.css(self._brake);self._$targets.removeStyle(targetStyles,self._prefix).removeAttr('data-inter-pos-x data-inter-pos-y data-final-pos-x data-final-pos-y data-orig-pos-x data-orig-pos-y data-orig-height data-orig-width data-final-height data-final-width data-inter-width data-inter-height data-orig-margin-right data-orig-margin-bottom data-inter-margin-right data-inter-margin-bottom data-final-margin-right data-final-margin-bottom');self._$hide.removeStyle('display');self._$parent.removeStyle('height transition perspective-distance perspective perspective-origin-x perspective-origin-y perspective-origin perspectiveOrigin',self._prefix);if(self._sorting){self._printSort();self._activeSort=self._newSortString;self._sorting=false;}
if(self._changingLayout){if(self._changingDisplay){self.layout.display=self._newDisplay;self._changingDisplay=false;}
if(self._changingClass){self._$parent.removeClass(self.layout.containerClass).addClass(self._newClass);self.layout.containerClass=self._newClass;self._changingClass=false;}
self._changingLayout=false;}
self._refresh();self._buildState();if(self._state.fail){self._$container.addClass(self.layout.containerClassFail);}
self._$show=jQuery();self._$hide=jQuery();if(window.requestAnimationFrame){requestAnimationFrame(unBrake);}
self._mixing=false;if(typeof self.callbacks._user==='function'){self.callbacks._user.call(self._domNode,self._state,self);}
if(typeof self.callbacks.onMixEnd==='function'){self.callbacks.onMixEnd.call(self._domNode,self._state,self);}
self._$container.trigger('mixEnd',[self._state,self]);if(self._state.fail){(typeof self.callbacks.onMixFail==='function')&&self.callbacks.onMixFail.call(self._domNode,self._state,self);self._$container.trigger('mixFail',[self._state,self]);}
if(self._loading){(typeof self.callbacks.onMixLoad==='function')&&self.callbacks.onMixLoad.call(self._domNode,self._state,self);self._$container.trigger('mixLoad',[self._state,self]);}
if(self._queue.length){self._execAction('_queue',0);self.multiMix(self._queue[0][0],self._queue[0][1],self._queue[0][2]);self._queue.splice(0,1);}
self._execAction('_cleanUp',1);self._loading=false;},_getPrefixedCSS:function(property,value,prefixValue){var self=this,styles={};for(i=0;i<2;i++){var prefix=i===0?self._prefix:'';prefixValue?styles[prefix+property]=prefix+value:styles[prefix+property]=value;}
return self._execFilter('_getPrefixedCSS',styles,arguments);},_getDelay:function(i){var self=this,n=typeof self.animation.staggerSequence==='function'?self.animation.staggerSequence.call(self._domNode,i,self._state):i,delay=self.animation.stagger?n*self.animation.staggerDuration:0;return self._execFilter('_getDelay',delay,arguments);},_parseMultiMixArgs:function(args){var self=this,output={command:null,animate:self.animation.enable,callback:null};for(var i=0;i<args.length;i++){var arg=args[i];if(arg!==null){if(typeof arg==='object'||typeof arg==='string'){output.command=arg;}else if(typeof arg==='boolean'){output.animate=arg;}else if(typeof arg==='function'){output.callback=arg;}}}
return self._execFilter('_parseMultiMixArgs',output,arguments);},_parseInsertArgs:function(args){var self=this,output={index:0,$object:jQuery(),multiMix:{filter:self._state.activeFilter},callback:null};for(var i=0;i<args.length;i++){var arg=args[i];if(typeof arg==='number'){output.index=arg;}else if(typeof arg==='object'&&arg instanceof jQuery){output.$object=arg;}else if(typeof arg==='object'&&self._helpers._isElement(arg)){output.$object=jQuery(arg);}else if(typeof arg==='object'&&arg!==null){output.multiMix=arg;}else if(typeof arg==='boolean'&&!arg){output.multiMix=false;}else if(typeof arg==='function'){output.callback=arg;}}
return self._execFilter('_parseInsertArgs',output,arguments);},_execAction:function(methodName,isPost,args){var self=this,context=isPost?'post':'pre';if(!self._actions.isEmptyObject&&self._actions.hasOwnProperty(methodName)){for(var key in self._actions[methodName][context]){self._actions[methodName][context][key].call(self,args);}}},_execFilter:function(methodName,value,args){var self=this;if(!self._filters.isEmptyObject&&self._filters.hasOwnProperty(methodName)){for(var key in self._filters[methodName]){return self._filters[methodName][key].call(self,args);}}else{return value;}},_helpers:{_camelCase:function(string){return string.replace(/-([a-z])/g,function(g){return g[1].toUpperCase();});},_isElement:function(el){if(window.HTMLElement){return el instanceof HTMLElement;}else{return(el!==null&&el.nodeType===1&&el.nodeName==='string');}}},isMixing:function(){var self=this;return self._execFilter('isMixing',self._mixing);},filter:function(){var self=this,args=self._parseMultiMixArgs(arguments);self._clicking&&(self._toggleString='');self.multiMix({filter:args.command},args.animate,args.callback);},sort:function(){var self=this,args=self._parseMultiMixArgs(arguments);self.multiMix({sort:args.command},args.animate,args.callback);},changeLayout:function(){var self=this,args=self._parseMultiMixArgs(arguments);self.multiMix({changeLayout:args.command},args.animate,args.callback);},multiMix:function(){var self=this,args=self._parseMultiMixArgs(arguments);self._execAction('multiMix',0,arguments);if(!self._mixing){if(self.controls.enable&&!self._clicking){self.controls.toggleFilterButtons&&self._buildToggleArray();self._updateControls(args.command,self.controls.toggleFilterButtons);}
(self._queue.length<2)&&(self._clicking=false);delete self.callbacks._user;if(args.callback)self.callbacks._user=args.callback;var sort=args.command.sort,filter=args.command.filter,changeLayout=args.command.changeLayout;self._refresh();if(sort){self._newSort=self._parseSort(sort);self._newSortString=sort;self._sorting=true;self._sort();}
if(filter!==undf){filter=(filter==='all')?self.selectors.target:filter;self._activeFilter=filter;}
self._filter();if(changeLayout){self._newDisplay=(typeof changeLayout==='string')?changeLayout:changeLayout.display||self.layout.display;self._newClass=changeLayout.containerClass||'';if(self._newDisplay!==self.layout.display||self._newClass!==self.layout.containerClass){self._changingLayout=true;self._changingClass=(self._newClass!==self.layout.containerClass);self._changingDisplay=(self._newDisplay!==self.layout.display);}}
self._$targets.css(self._brake);self._goMix(args.animate^self.animation.enable?args.animate:self.animation.enable);self._execAction('multiMix',1,arguments);}else{if(self.animation.queue&&self._queue.length<self.animation.queueLimit){self._queue.push(arguments);(self.controls.enable&&!self._clicking)&&self._updateControls(args.command);self._execAction('multiMixQueue',1,arguments);}else{if(typeof self.callbacks.onMixBusy==='function'){self.callbacks.onMixBusy.call(self._domNode,self._state,self);}
self._$container.trigger('mixBusy',[self._state,self]);self._execAction('multiMixBusy',1,arguments);}}},insert:function(){var self=this,args=self._parseInsertArgs(arguments),callback=(typeof args.callback==='function')?args.callback:null,frag=document.createDocumentFragment(),target=(function(){self._refresh();if(self._$targets.length){return(args.index<self._$targets.length||!self._$targets.length)?self._$targets[args.index]:self._$targets[self._$targets.length-1].nextElementSibling;}else{return self._$parent[0].children[0];}})();self._execAction('insert',0,arguments);if(args.$object){for(var i=0;i<args.$object.length;i++){var el=args.$object[i];frag.appendChild(el);frag.appendChild(document.createTextNode(' '));}
self._$parent[0].insertBefore(frag,target);}
self._execAction('insert',1,arguments);if(typeof args.multiMix==='object'){self.multiMix(args.multiMix,callback);}},prepend:function(){var self=this,args=self._parseInsertArgs(arguments);self.insert(0,args.$object,args.multiMix,args.callback);},append:function(){var self=this,args=self._parseInsertArgs(arguments);self.insert(self._state.totalTargets,args.$object,args.multiMix,args.callback);},getOption:function(string){var self=this,getProperty=function(obj,prop){var parts=prop.split('.'),last=parts.pop(),l=parts.length,i=1,current=parts[0]||prop;while((obj=obj[current])&&i<l){current=parts[i];i++;}
if(obj!==undf){return obj[last]!==undf?obj[last]:obj;}};return string?self._execFilter('getOption',getProperty(self,string),arguments):self;},setOptions:function(config){var self=this;self._execAction('setOptions',0,arguments);typeof config==='object'&&jQuery.extend(true,self,config);self._execAction('setOptions',1,arguments);},getState:function(){var self=this;return self._execFilter('getState',self._state,self);},forceRefresh:function(){var self=this;self._refresh(false,true);},destroy:function(hideAll){var self=this,filters=jQuery.MixItUp.prototype._bound._filter,sorts=jQuery.MixItUp.prototype._bound._sort;self._execAction('destroy',0,arguments);self._$body.add(jQuery(self.selectors.sort)).add(jQuery(self.selectors.filter)).off('.mixItUp');for(var i=0;i<self._$targets.length;i++){var target=self._$targets[i];hideAll&&(target.style.display='');delete target.mixParent;}
self._execAction('destroy',1,arguments);if(filters[self.selectors.filter]&&filters[self.selectors.filter]>1){filters[self.selectors.filter]--;}else if(filters[self.selectors.filter]===1){delete filters[self.selectors.filter];}
if(sorts[self.selectors.sort]&&sorts[self.selectors.sort]>1){sorts[self.selectors.sort]--;}else if(sorts[self.selectors.sort]===1){delete sorts[self.selectors.sort];}
delete jQuery.MixItUp.prototype._instances[self._id];}};jQuery.fn.mixItUp=function(){var args=arguments,dataReturn=[],eachReturn,_instantiate=function(domNode,settings){var instance=new jQuery.MixItUp(),rand=function(){return('00000'+(Math.random()*16777216<<0).toString(16)).substr(-6).toUpperCase();};instance._execAction('_instantiate',0,arguments);domNode.id=!domNode.id?'MixItUp'+rand():domNode.id;if(!instance._instances[domNode.id]){instance._instances[domNode.id]=instance;instance._init(domNode,settings);}
instance._execAction('_instantiate',1,arguments);};eachReturn=this.each(function(){if(args&&typeof args[0]==='string'){var instance=jQuery.MixItUp.prototype._instances[this.id];if(args[0]==='isLoaded'){dataReturn.push(instance?true:false);}else{var data=instance[args[0]](args[1],args[2],args[3]);if(data!==undf)dataReturn.push(data);}}else{_instantiate(this,args[0]);}});if(dataReturn.length){return dataReturn.length>1?dataReturn:dataReturn[0];}else{return eachReturn;}};jQuery.fn.removeStyle=function(style,prefix){prefix=prefix?prefix:'';return this.each(function(){var el=this,styles=style.split(' ');for(var i=0;i<styles.length;i++){for(var j=0;j<4;j++){switch(j){case 0:var prop=styles[i];break;case 1:var prop=jQuery.MixItUp.prototype._helpers._camelCase(prop);break;case 2:var prop=prefix+styles[i];break;case 3:var prop=jQuery.MixItUp.prototype._helpers._camelCase(prefix+styles[i]);}
if(el.style[prop]!==undf&&typeof el.style[prop]!=='unknown'&&el.style[prop].length>0){el.style[prop]='';}
if(!prefix&&j===1)break;}}
if(el.attributes&&el.attributes.style&&el.attributes.style!==undf&&el.attributes.style.value===''){el.attributes.removeNamedItem('style');}});};})(jQuery);var challengeFilters={$filter:null,outputString:'',init:function(){var self=this;self.$filter=jQuery('button.challenge-filter');self.$container=jQuery("#challenge-continer");self.$sort=jQuery("#challenge-sort");self.bindHandlers();},bindHandlers:function(){var self=this;self.$filter.unbind('click').click(function(e){jQuery(e.target).toggleClass("active");e.preventDefault();self.parseFilters();});self.$sort.off();self.$sort.on('change',function(){self.sortResults();});},parseFilters:function(){var self=this;var activeFilters=[];self.outputString='';self.$filter.each(function(){if(jQuery(this).hasClass("active")){if((jQuery(this).attr('data-filter')!=".filter-archived")&&(jQuery(this).attr('data-filter')!=".filter-ended")){activeFilters.push(jQuery(this).attr('data-filter'));}}});if(activeFilters.length>0){for(var i=0;i<activeFilters.length;i++){if(self.outputString){self.outputString+=",";}
self.outputString+=".filter-active"+activeFilters[i];if(jQuery(".b-challenges__category-filter-item .filter-archived").hasClass("active")){self.outputString+=",.filter-archived"+activeFilters[i];}
if(jQuery(".b-challenges__category-filter-item .filter-ended").hasClass("active")){self.outputString+=",.filter-ended"+activeFilters[i];}}}else{self.outputString='.filter-active';if(jQuery(".b-challenges__category-filter-item .filter-archived").hasClass("active")){self.outputString+=",.filter-archived";}
if(jQuery(".b-challenges__category-filter-item .filter-ended").hasClass("active")){self.outputString+=",.filter-ended";}}
if(jQuery('.b-single-challenge__search-keyword').length===0){jQuery('#challenge-container').mixItUp();}
jQuery('#challenge-container').on('mixEnd',function(){jQuery('.b-challenge__title').each(function(){var h=jQuery(this).height();var lh=parseInt(jQuery(this).css('line-height'));var challengeId=jQuery(this).data('id');if(h/lh==3){jQuery('#challenge_excerpt-'+challengeId).addClass('b-challenge__excerpt-longtitle');}else if(h/lh>3){jQuery('#challenge_excerpt-'+challengeId).addClass('b-challenge__excerpt-longesttitle');}})});if(self.$container.mixItUp('isLoaded')){jQuery('#challenge-container').mixItUp('filter',self.outputString);}},sortResults:function(){var self=this;jQuery('#challenge-container').mixItUp('sort',self.$sort[0].value);}};var resultFilters={$filter:null,outputString:'',init:function(){var self=this;self.$filter=jQuery('button.filter');self.$container=jQuery("#results-continer");self.$sort=jQuery("#results-sort");self.$keyword=jQuery("#keyword-search");self.$reset=jQuery(".b-sidebar__section-reset-button");self.bindHandlers();},bindHandlers:function(){var delay=(function(){var timer=0;return function(callback,ms){clearTimeout(timer);timer=setTimeout(callback,ms);};})();var self=this;self.$filter.unbind('click').click(function(e){if(jQuery(this).hasClass("filter-start")){jQuery(".filter-milestone-item").removeClass("active");jQuery(this).addClass("active");}else{}
jQuery(e.target).toggleClass("active");if(jQuery(this).hasClass("filter-milestone-item")){if(parseInt(jQuery(this).attr("data-milestone"))>0){jQuery(".filter-milestone-item").removeClass("active");jQuery(e.target).toggleClass("active");jQuery(".milestone-line").removeClass("milestone-line-active");}else if(parseInt(jQuery(this).attr("data-milestone"))==0){jQuery(".filter-milestone-item").removeClass("active");jQuery(".milestone-line").removeClass("milestone-line-active");jQuery(".filter-milestone-item").each(function(){if(parseInt(jQuery(this).attr("data-milestone"))==0){jQuery(this).addClass("active");}});}else if(parseInt(jQuery(this).attr("data-milestone"))==-1){jQuery(".filter-milestone-item").removeClass("active");jQuery(".milestone-line").removeClass("milestone-line-active");jQuery(e.target).toggleClass("active");}}
e.preventDefault();self.parseFilters();});self.$reset.on('click',function(e){e.preventDefault();self.resetFilters();self.parseFilters();});self.$sort.on('change',function(){});self.$keyword.on('keyup',function(){delay(function(){self.textFilter();},200);});},resetFilters:function(){var self=this;self.$filter.each(function(){jQuery(this).removeClass("active");});},parseFilters:function(){var self=this;console.log("parseFilters");var activeFilters=[];jQuery("#selected-filters").html('');self.outputString='';self.$filter.each(function(){if(jQuery(this).hasClass("active")){if((jQuery(this).attr('data-filter')!=".filter-archived")&&(jQuery(this).attr('data-filter')!=".filter-ended")){activeFilters.push(jQuery(this).attr('data-filter'));var x=jQuery(this).attr('data-filter');x=x.replace(".","");if(!(jQuery(this).hasClass("filter-milestone-item"))){jQuery("#selected-filters").append('<a class="remove-tag" href="javascript:removeTag(\''+x+'\');">'+jQuery(this).text()+'</a>');}}}});var milestonesArray=[];var themesArray=[];var tagsArray=[];var resultsArray=[];var milestoneFilter='';for(var x=0;x<activeFilters.length;x++){if(activeFilters[x].match(/^\.filter\-\d+$/)){themesArray.push(activeFilters[x]);}else if(activeFilters[x].match(/^\.filter\-milestone\d+$/)){milestonesArray.push(activeFilters[x]);}else if(activeFilters[x].match(/^\.tag/)){tagsArray.push(activeFilters[x]);}}
function allPossibleCases(arr){if(arr.length===0){return[];}
if(arr.length==1){return arr[0];}else{var result=[];var allCasesOfRest=allPossibleCases(arr.slice(1));for(var i=0;i<allCasesOfRest.length;i++){for(var j=0;j<arr[0].length;j++){result.push(arr[0][j]+allCasesOfRest[i]);}}
return result;}}
var resultOutput=[];if(themesArray.length||tagsArray.length||milestonesArray.length){if(!themesArray.length){themesArray.push('');}
if(!tagsArray.length){tagsArray.push('');}
if(!milestonesArray.length){milestonesArray.push('');}
resultOutput=allPossibleCases([milestonesArray,themesArray,tagsArray]);}
if(activeFilters.length>0){if(resultOutput.length){for(var x=0;x<resultOutput.length;x++){self.outputString+=resultOutput[x]+',';}
self.outputString=self.outputString.substring(0,self.outputString.length-1);}else{for(var i=0;i<activeFilters.length;i++){if(self.outputString){self.outputString+=",";}
self.outputString+=".filter-active"+activeFilters[i];if(jQuery(".b-challenges__category-filter-item .filter-archived").hasClass("active")){self.outputString+=".filter-archived"+activeFilters[i];}
if(jQuery(".b-challenges__category-filter-item .filter-ended").hasClass("active")){self.outputString+=".filter-ended"+activeFilters[i];}}}}else{self.outputString='.filter-active';if(jQuery(".b-challenges__category-filter-item .filter-archived").hasClass("active")){self.outputString+=".filter-archived";}
if(jQuery(".b-challenges__category-filter-item .filter-ended").hasClass("active")){self.outputString+=".filter-ended";}}
var filterArray=self.outputString.split(',');var trimmedVal;var tagsSelected='';var themesSelected='';console.log("FILTER: "+self.outputString);jQuery('#active_tag_filters').val('');jQuery('#active_theme_filters').val('');for(var x=0;x<filterArray.length;x++){var val=filterArray[x].replace('.filter-active.','');if(val.match(/filter-/)){trimmedVal=val.replace('filter-','');themesSelected+=trimmedVal+',';}else if(val.match(/tag-/)){trimmedVal=val.replace('tag-','');tagsSelected+=trimmedVal+',';}}
jQuery('#active_tag_filters').val(tagsSelected);jQuery('#active_theme_filters').val(themesSelected);if(self.$container.mixItUp('isLoaded')){jQuery('#results-container').mixItUp('setOptions',{callbacks:{onMixEnd:function(){console.log('end');var dialogtopOuter=$('loadMoreButton');if(dialogtopOuter!=null){var dialogtop=$('loadMoreButton').viewportOffset().top;var loadMoreButton=$('loadMoreButton');if((dialogtop>0)&&(dialogtop+loadMoreButton.getHeight()<document.viewport.getHeight())){var loadMoreAddressElement=$('loadMoreAddress');if(loadMoreAddressElement!=null){loadMoreAddressValue=$F(loadMoreAddressElement);Element.remove(loadMoreAddressElement);loadMore($('results-container'),loadMoreAddressValue,loadMoreButton,false);}}}}}});jQuery('#results-container').mixItUp('filter',self.outputString);jQuery('#results-container').mixItUp('setOptions',{animation:{enable:true,effects:'fade scale',duration:600,easing:'ease',perspectiveDistance:'3000',perspectiveOrigin:'50% 50%',queue:true,queueLimit:1,animateChangeLayout:false,animateResizeContainer:true,animateResizeTargets:false,staggerSequence:false,reverseOut:false}});}},textFilter:function(){var self=this,$matching=jQuery();if((self.$keyword.val().length)>0){jQuery('.mix').each(function(){$this=jQuery("this");if(jQuery(this).find('.b-idea__title-link').text().toLowerCase().match(self.$keyword.val())){$matching=$matching.add(this);}else{$matching=$matching.not(this);}});jQuery('#results-container').mixItUp('filter',$matching);}else{self.parseFilters();}},sortResults:function(){var self=this;jQuery('#results-container').mixItUp('sort',self.$sort[0].value);}};function removeTag(tag){jQuery("."+tag).toggleClass("active");resultFilters.parseFilters();};function initFilters(){resultFilters.init();jQuery('#results-container').mixItUp({controls:{enable:false},callbacks:{onMixEnd:function(state){jQuery(".result-count").html(state.totalShow);},onMixFail:function(){}}});jQuery('#results-container').mixItUp('setOptions',{animation:{enable:true,effects:'fade scale',duration:600,easing:'ease',perspectiveDistance:'3000',perspectiveOrigin:'50% 50%',queue:true,queueLimit:1,animateChangeLayout:false,animateResizeContainer:true,animateResizeTargets:false,staggerSequence:false,reverseOut:false}});}
var countdownTimer;var seconds=0;function timer(){var days=Math.floor(seconds/24/60/60);var hoursLeft=Math.floor((seconds)-(days*86400));var hours=Math.floor(hoursLeft/3600);var minutesLeft=Math.floor((hoursLeft)-(hours*3600));var minutes=Math.floor(minutesLeft/60);var remainingSeconds=seconds%60;if(remainingSeconds<10){remainingSeconds="0"+remainingSeconds;}
var timeString="";if(days>0){timeString=days+" days ";}
if(hours<10){timeString+="0"+hours;}else{timeString+=hours;}
if(minutes<10){timeString+=":0"+minutes;}else{timeString+=":"+minutes;}
if(Math.round(remainingSeconds)<10){timeString+=":0"+Math.round(remainingSeconds);}else{timeString+=":"+Math.round(remainingSeconds);}
jQuery("#b-progress-bar__progress--countdown .time").html(timeString);if(seconds<=0){clearInterval(countdownTimer);jQuery("#b-progress-bar__progress--countdown .time").html("Completed");}else{seconds--;}}
function initPhaseTimeline(){jQuery(".b-single-challenge__timeline-section-progress--active .b-progress-bar__progress").each(function(){jQuery(this).delay(2000).width(0).animate({width:jQuery("#b-progress-bar__progress--timer").attr("data-progress")+"%"},2000);jQuery("#b-progress-bar__progress--countdown").delay(2000).animate({height:"37px",opacity:1,paddingTop:"22px"},1000);});if(jQuery("#b-progress-bar__progress--timer").length){var reggie=/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/;var dateArray=reggie.exec(jQuery("#b-progress-bar__progress--timer").attr("data-deadline"));var dateObject=new Date((+dateArray[1]),(+dateArray[2])-1,(+dateArray[3]),(+dateArray[4]),(+dateArray[5]),(+dateArray[6]));var _myDate=new Date();var _userOffset=_myDate.getTimezoneOffset()*60;var _secs=parseInt((new Date((+dateArray[1]),(+dateArray[2])-1,(+dateArray[3]),(+dateArray[4]),(+dateArray[5]),(+dateArray[6])).getTime()-new Date().getTime())/1000)-_userOffset;console.log(_secs);seconds=_secs;var countdownTimer=setInterval('timer()',1000);}}
(function(jQuery){jQuery.fn.tipr=function(options){var set=jQuery.extend({'speed':200,'mode':'bottom'},options);return this.each(function(){var tipr_cont='.tipr_container_'+set.mode;jQuery(this).hover(function()
{var d_m=set.mode;if(jQuery(this).attr('data-mode'))
{d_m=jQuery(this).attr('data-mode')
tipr_cont='.tipr_container_'+d_m;}
var out='<div class="tipr_container_'+d_m+'"><div class="tipr_point_'+d_m+'"><div class="tipr_content">'+jQuery(this).attr('data-tooltip')+'</div></div></div>';jQuery(this).append(out);var w_t=jQuery(tipr_cont).outerWidth();var w_e=jQuery(this).width();var m_l=(w_e/2)-(w_t/2);jQuery(tipr_cont).css('margin-left','-85px');jQuery(this).removeAttr('title alt');jQuery(tipr_cont).fadeIn(set.speed);},function()
{jQuery(tipr_cont).remove();});});};})(jQuery);jQuery(function(){var jQueryblocks=jQuery('.parallax-scroll');var jQuerywindow=jQuery(window);jQuerywindow.on('scroll',function(e){jQueryblocks.each(function(i,elem){var cur_pos=parseInt(jQuery(document).scrollTop())+parseInt(jQuery(this).attr("data-fixedoffset"));if(cur_pos>=parseInt(jQuery(this).offset().top)){jQuery(this).css("background-attachment","fixed").css("background-position","center "+jQuery(this).attr("data-fixedoffset")+"px");}else{jQuery(this).css("background-attachment","scroll").css("background-position","center top");}});});});;(function(jQuery){'use strict';var pluginName='selectric',classList='Input Items Open Disabled TempShow HideSelect Wrapper Hover Responsive Above Scroll Group GroupLabel',bindSufix='.sl',defaults={onChange:function(elm){jQuery(elm).change();},maxHeight:300,keySearchTimeout:500,arrowButtonMarkup:'<b class="button">&#x25be;</b>',disableOnMobile:true,openOnHover:false,hoverIntentTimeout:500,expandToItemText:false,responsive:false,preventWindowScroll:true,inheritOriginalWidth:false,allowWrap:true,customClass:{prefix:pluginName,camelCase:false,overwrite:true},optionsItemBuilder:'{text}',labelBuilder:'{text}'},hooks={add:function(callbackName,hookName,fn){if(!this[callbackName])
this[callbackName]={};this[callbackName][hookName]=fn;},remove:function(callbackName,hookName){delete this[callbackName][hookName];}},_utils={replaceDiacritics:function(s){var d='40-46 50-53 54-57 62-70 71-74 61 47 77'.replace(/\d+/g,'\\3$&').split(' '),k=d.length;while(k--)
s=s.toLowerCase().replace(RegExp('['+d[k]+']','g'),'aeiouncy'.charAt(k));return s;},format:function(f){var a=arguments;return(""+f).replace(/{(\d+|(\w+))}/g,function(s,i,p){return p&&a[1]?a[1][p]:a[i]})},nextEnabledItem:function(selectItems,selected){while(selectItems[selected=(selected+1)%selectItems.length].disabled){}
return selected;},previousEnabledItem:function(selectItems,selected){while(selectItems[selected=(selected>0?selected:selectItems.length)-1].disabled){}
return selected;},toDash:function(str){return str.replace(/([a-z])([A-Z])/g,'$1-$2').toLowerCase();},triggerCallback:function(fn,scope){var elm=scope.element,func=scope.options['on'+fn];if(jQuery.isFunction(func))
func.call(elm,elm,scope);if(hooks[fn]){jQuery.each(hooks[fn],function(){this.call(elm,elm,scope);});}
jQuery(elm).trigger(pluginName+'-'+_utils.toDash(fn),scope);}},$doc=jQuery(document),$win=jQuery(window),Selectric=function(element,opts){var _this=this,$original=jQuery(element),$input,$items,$itemsScroll,$wrapper,$label,$outerWrapper,$li,isOpen=false,isEnabled=false,selected,currValue,itemsHeight,itemsInnerHeight,finalWidth,optionsLength,eventTriggers,isMobile=/android|ip(hone|od|ad)/i.test(navigator.userAgent),tabindex=$original.prop('tabindex'),labelBuilder;function _init(opts){_this.options=jQuery.extend(true,{},defaults,_this.options,opts);_this.classes={};_this.element=element;_utils.triggerCallback('BeforeInit',_this);if(_this.options.disableOnMobile&&isMobile){_this.disableOnMobile=true;return;}
_destroy(true);var customClass=_this.options.customClass,postfixes=classList.split(' '),originalWidth=$original.width();jQuery.each(postfixes,function(i,currClass){var c=customClass.prefix+currClass;_this.classes[currClass.toLowerCase()]=customClass.camelCase?c:_utils.toDash(c);});$input=jQuery('<input/>',{'class':_this.classes.input,'readonly':isMobile});$items=jQuery('<div/>',{'class':_this.classes.items,'tabindex':-1});$itemsScroll=jQuery('<div/>',{'class':_this.classes.scroll});$wrapper=jQuery('<div/>',{'class':customClass.prefix,'html':_this.options.arrowButtonMarkup});$label=jQuery('<p class="label"/>');$outerWrapper=$original.wrap('<div>').parent().append($wrapper.prepend($label),$items,$input);eventTriggers={open:_open,close:_close,destroy:_destroy,refresh:_refresh,init:_init};$original.on(eventTriggers).wrap('<div class="'+_this.classes.hideselect+'">');jQuery.extend(_this,eventTriggers);labelBuilder=_this.options.labelBuilder;if(_this.options.inheritOriginalWidth&&originalWidth>0)
$outerWrapper.width(originalWidth);_populate();}
function _populate(){_this.items=[];var $options=$original.children(),_$li='<ul>',selectedIndex=$options.filter(':selected').index(),currIndex=0;currValue=(selected=~selectedIndex?selectedIndex:0);if(optionsLength=$options.length){$options.each(function(){var $elm=jQuery(this);if($elm.is('optgroup')){var groupDisabled=$elm.prop('disabled'),$children=$elm.children();_$li+=_utils.format('<ul class="{1}"><li class="{2}">{3}</li>',jQuery.trim([_this.classes.group,groupDisabled?'disabled':'',$elm.prop('class')].join(' ')),_this.classes.grouplabel,$elm.prop('label'));if(groupDisabled){$children.prop('disabled',true);}
$children.each(buildOption);_$li+='</ul>';}else{buildOption.call($elm);}
function buildOption(){var $elm=jQuery(this),optionText=$elm.html(),selectDisabled=$elm.prop('disabled'),itemBuilder=_this.options.optionsItemBuilder;_this.items[currIndex]={element:$elm,value:$elm.val(),text:optionText,slug:_utils.replaceDiacritics(optionText),disabled:selectDisabled};_$li+=_utils.format('<li data-index="{1}" class="{2}">{3}</li>',currIndex,jQuery.trim([currIndex==currValue?'selected':'',currIndex==optionsLength-1?'last':'',selectDisabled?'disabled':''].join(' ')),jQuery.isFunction(itemBuilder)?itemBuilder(_this.items[currIndex],$elm,currIndex):_utils.format(itemBuilder,_this.items[currIndex]));currIndex++;}});$items.append($itemsScroll.html(_$li+'</ul>'));$label.html(jQuery.isFunction(labelBuilder)?labelBuilder(_this.items[currValue]):_utils.format(labelBuilder,_this.items[currValue]))}
$wrapper.add($original).add($outerWrapper).add($input).off(bindSufix);$outerWrapper.prop('class',[_this.classes.wrapper,_this.options.customClass.overwrite?$original.prop('class').replace(/\S+/g,_this.options.customClass.prefix+'-$&'):$original.prop('class'),_this.options.responsive?_this.classes.responsive:''].join(' '));if(!$original.prop('disabled')){isEnabled=true;$outerWrapper.removeClass(_this.classes.disabled).on('mouseenter'+bindSufix+' mouseleave'+bindSufix,function(e){jQuery(this).toggleClass(_this.classes.hover);if(_this.options.openOnHover){clearTimeout(_this.closeTimer);e.type=='mouseleave'?_this.closeTimer=setTimeout(_close,_this.options.hoverIntentTimeout):_open();}});$wrapper.on('click'+bindSufix,function(e){isOpen?_close():_open(e);});$input.prop({tabindex:tabindex,disabled:false}).on('keypress'+bindSufix,_handleSystemKeys).on('keydown'+bindSufix,function(e){_handleSystemKeys(e);clearTimeout(_this.resetStr);_this.resetStr=setTimeout(function(){$input.val('');},_this.options.keySearchTimeout);var key=e.keyCode||e.which;if(key>36&&key<41){if(!_this.options.allowWrap){if((key<39&&selected==0)||(key>38&&(selected+1)==_this.items.length)){return;}}
_select(_utils[(key<39?'previous':'next')+'EnabledItem'](_this.items,selected));}}).on('focusin'+bindSufix,function(e){$input.one('blur',function(){$input.blur();});isOpen||_open(e);}).on('oninput'in $input[0]?'input':'keyup',function(){if($input.val().length){jQuery.each(_this.items,function(i,elm){if(RegExp('^'+$input.val(),'i').test(elm.slug)&&!elm.disabled){_select(i);return false;}});}});$original.prop('tabindex',false);$li=jQuery('li',$items.removeAttr('style')).on({mousedown:function(e){e.preventDefault();e.stopPropagation();},click:function(){_select(jQuery(this).data('index'),true);return false;}}).filter('[data-index]');}else{$outerWrapper.addClass(_this.classes.disabled);$input.prop('disabled',true);}
_utils.triggerCallback('Init',_this);}
function _refresh(){_utils.triggerCallback('Refresh',_this);_populate();}
function _handleSystemKeys(e){var key=e.keyCode||e.which;if(key==13){e.preventDefault();}
if(/^(9|13|27)$/.test(key)){e.stopPropagation();_select(selected,true);}}
function _calculateOptionsDimensions(){var hiddenChildren=$items.closest(':visible').children(':hidden').addClass(_this.classes.tempshow),maxHeight=_this.options.maxHeight,itemsWidth=$items.outerWidth(),wrapperWidth=$wrapper.outerWidth()-(itemsWidth-$items.width());if(!_this.options.expandToItemText||wrapperWidth>itemsWidth)
finalWidth=wrapperWidth;else{$items.css('overflow','scroll');$outerWrapper.width(9e4);finalWidth=$items.width();$items.css('overflow','');$outerWrapper.width('');}
$items.width(finalWidth).height()>maxHeight&&$items.height(maxHeight);hiddenChildren.removeClass(_this.classes.tempshow);}
function _open(e){_utils.triggerCallback('BeforeOpen',_this);if(e){e.preventDefault();e.stopPropagation();}
if(isEnabled){_calculateOptionsDimensions();jQuery('.'+_this.classes.hideselect,'.'+_this.classes.open).children()[pluginName]('close');isOpen=true;itemsHeight=$items.outerHeight();itemsInnerHeight=$items.height();$outerWrapper.addClass(_this.classes.open);$input.val('').is(':focus')||$input.focus();$doc.on('click'+bindSufix,_close).on('scroll'+bindSufix,_isInViewport);_isInViewport();if(_this.options.preventWindowScroll){$doc.on('mousewheel'+bindSufix+' DOMMouseScroll'+bindSufix,'.'+_this.classes.scroll,function(e){var orgEvent=e.originalEvent,scrollTop=jQuery(this).scrollTop(),deltaY=0;if('detail'in orgEvent){deltaY=orgEvent.detail*-1;}
if('wheelDelta'in orgEvent){deltaY=orgEvent.wheelDelta;}
if('wheelDeltaY'in orgEvent){deltaY=orgEvent.wheelDeltaY;}
if('deltaY'in orgEvent){deltaY=orgEvent.deltaY*-1;}
if(scrollTop==(this.scrollHeight-itemsInnerHeight)&&deltaY<0||scrollTop==0&&deltaY>0){e.preventDefault();}});}
_detectItemVisibility(selected);_utils.triggerCallback('Open',_this);}}
function _isInViewport(){$outerWrapper.toggleClass(_this.classes.above,$outerWrapper.offset().top+$outerWrapper.outerHeight()+itemsHeight>$win.scrollTop()+$win.height());}
function _close(){_utils.triggerCallback('BeforeClose',_this);if(currValue!=selected){_utils.triggerCallback('BeforeChange',_this);var text=_this.items[selected].text;$original.prop('selectedIndex',currValue=selected).data('value',text);$label.html(jQuery.isFunction(labelBuilder)?labelBuilder(_this.items[selected]):_utils.format(labelBuilder,_this.items[selected]))
_utils.triggerCallback('Change',_this);}
$doc.off(bindSufix);$outerWrapper.removeClass(_this.classes.open);isOpen=false;_utils.triggerCallback('Close',_this);}
function _select(index,close){if(index==undefined){return;}
if(!_this.items[index].disabled){$li.removeClass('selected').eq(selected=index).addClass('selected');_detectItemVisibility(index);close&&_close();}}
function _detectItemVisibility(index){var liHeight=$li.eq(index).outerHeight(),liTop=$li[index].offsetTop,itemsScrollTop=$itemsScroll.scrollTop(),scrollT=liTop+liHeight*2;$itemsScroll.scrollTop(scrollT>itemsScrollTop+itemsHeight?scrollT-itemsHeight:liTop-liHeight<itemsScrollTop?liTop-liHeight:itemsScrollTop);}
function _destroy(preserveData){if(isEnabled){$items.add($wrapper).add($input).remove();!preserveData&&$original.removeData(pluginName).removeData('value');$original.prop('tabindex',tabindex).off(bindSufix).off(eventTriggers).unwrap().unwrap();isEnabled=false;}}
_init(opts);};jQuery.fn[pluginName]=function(args){return this.each(function(){var data=jQuery.data(this,pluginName);if(data&&!data.disableOnMobile)
(''+args===args&&data[args])?data[args]():data.init(args);else
jQuery.data(this,pluginName,new Selectric(this,args));});};jQuery.fn[pluginName].hooks=hooks;}(jQuery));function convertHTML(html){var newHtml=jQuery.trim(html),$html=jQuery(newHtml),$empty=jQuery();$html.each(function(index,value){if(value.nodeType===1){$empty=$empty.add(this);}});return $empty;};function loadIdeas(category_id,phase_id){console.log("loadIdeas("+category_id+", "+phase_id+")");jQuery.ajax('/category/'+category_id+'?sortBy=newest&fullRight=1&forPhase='+phase_id,{beforeSend:function(){jQuery('.i-ideas-list').css('opacity',0.5);},success:function(data){jQuery('.i-ideas-list').css('opacity',1);jQuery('#main-challenge-container').html(data);$html=convertHTML(jQuery('#results-container').html());jQuery('#results-container').html($html);document.fire("crowdworks:updateComplete");}});}
function initialiseMixItUp(reset){console.log("initialiseMixItUp("+reset+")");if(jQuery('#challenge-container').mixItUp('isLoaded')){jQuery('#challenge-container').mixItUp('destroy',true);};if(jQuery('#results-container').mixItUp('isLoaded')){jQuery('#results-container').mixItUp('destroy',true);};jQuery('#challenge-container').mixItUp({controls:{enable:false},load:{sort:jQuery("#challenge-sort").find(":selected").val(),filter:'.filter-active'},callbacks:{onMixEnd:function(state){jQuery(".result-count").html(state.totalShow);},onMixFail:function(){}}});jQuery('#results-container').mixItUp({controls:{enable:false},load:{sort:jQuery("#results-sort").find(":selected").val()},callbacks:{onMixEnd:function(state){jQuery(".result-count").html(state.totalShow);},onMixFail:function(){}}});jQuery('#challenge-container').mixItUp('setOptions',{animation:{enable:true,effects:'fade scale',duration:600,easing:'ease',perspectiveDistance:'3000',perspectiveOrigin:'50% 50%',queue:true,queueLimit:1,animateChangeLayout:false,animateResizeContainer:true,animateResizeTargets:false,staggerSequence:false,reverseOut:false}});jQuery('#results-container').mixItUp('setOptions',{animation:{enable:true,effects:'fade scale',duration:600,easing:'ease',perspectiveDistance:'3000',perspectiveOrigin:'50% 50%',queue:true,queueLimit:1,animateChangeLayout:false,animateResizeContainer:true,animateResizeTargets:false,staggerSequence:false,reverseOut:false}});}
function setSizes(){var phase_count=jQuery('.i-phase').length;var phase_width=100/phase_count;jQuery('.i-phase').css('width',(phase_width-phase_count)+'%');jQuery('.i-phase--active').css('width',((phase_width+(phase_count*(phase_count-1)))-1)+'%');}
function startupNewUiPage(){}
function startupNewUiAjax(){console.log("startupNewUiAjax()");var isiPad=navigator.userAgent.match(/iPad/i)!=null;if(isiPad){jQuery('.i-header').css('position','fixed');}
var pageType=jQuery('#currentPage').val();if(jQuery('#results-sort').parents('.selectric-i-mix-sort').length==0){jQuery('.i-mix-sort').selectric();}else{var $sortSelect=jQuery('#results-sort');var $sortParent=$sortSelect.parents('.viewoptions-wrapper');var $selectricWrapper=$sortParent.find('.selectric-wrapper');var selectClone=$sortSelect.clone();$selectricWrapper.remove();$sortParent.append(selectClone);jQuery('.i-mix-sort').selectric();}
if(jQuery('#challenge-sort').parents('.selectric-i-mix-sort').length==0){jQuery('.i-mix-sort').selectric();}else{var $sortSelect=jQuery('#challenge-sort');var $sortParent=$sortSelect.parents('.b-challenges__options-sort');var $selectricWrapper=$sortParent.find('.selectric-wrapper');var selectClone=$sortSelect.clone();$selectricWrapper.remove();$sortParent.append(selectClone);jQuery('.i-mix-sort').selectric();}
jQuery('#post-idea-trigger, .b-header__new-post-link').off();if(typeof(notLoggedIn)==='undefined'&&typeof(userNotValidated)==='undefined'){jQuery('#post-idea-trigger').click(function(e){currentCategoryId=jQuery(this).data('category-id');var categoryId=jQuery(this).data('current-category-id');if(typeof currentCategoryId==="undefined"){currentCategoryId=0;}
openNewIdeaForm(currentCategoryId,categoryId);return false;});}
if(pageType=='post'){if(typeof(notLoggedIn)==='undefined'&&typeof(userNotValidated)==='undefined'){var currentCategoryId=null;jQuery('#post-idea-trigger, .b-header__new-post-link').off();jQuery('#post-idea-trigger, .b-header__new-post-link').click(function(e){currentCategoryId=jQuery(this).data('category-id');if(typeof currentCategoryId==="undefined"){currentCategoryId=0;}
var categoryId=jQuery(this).data('current-category-id');openNewIdeaForm(currentCategoryId,categoryId);return false;});jQuery('.b-single-post--trigger').off();jQuery(".b-single-post--trigger").on("click",function(event){var confirm=window.confirm("You will lose your data permanently. Are you sure?");if(confirm){jQuery(".b-single-post--underlay").fadeToggle();jQuery(".b-single-post--wrapper").fadeToggle();if(jQuery(this).data('category-id')){currentCategoryId=jQuery(this).data('category-id');}}
return false;});}}else{jQuery('.b-header__new-post-challenge-selector-challenges li').each(function(){jQuery(this).off();jQuery(this).click(function(e){e.preventDefault();if(!jQuery(this).hasClass('noPosts-challenge')){var catId=jQuery(this).data('id');openNewIdeaForm(catId);}});});jQuery('.b-header__new-post-link').click(function(e){e.preventDefault();if(!jQuery('.b-header__new-post-challenge-selector').hasClass('b-header__new-post-challenge-selector--opened')){jQuery('.b-header__new-post-challenge-selector').addClass('b-header__new-post-challenge-selector--opened');jQuery('.b-header__new-post-challenge-selector').slideDown();Crowdicity.popUpManager.register(function(){jQuery('.b-header__new-post-challenge-selector').slideUp().removeClass('b-header__new-post-challenge-selector--opened');});}});}
jQuery('button').off();jQuery('button').on('click',function(e){if(jQuery(this).hasClass('toggle-grid')){if(!jQuery(this).hasClass('toggle-active')){jQuery(this).addClass('toggle-active',1000);jQuery('#toggle-list').removeClass('toggle-active');}
jQuery('#results-container').removeClass('results-view-list');}
else if(jQuery(this).hasClass('toggle-list')){if(!jQuery(this).hasClass('toggle-active')){jQuery(this).addClass('toggle-active',1000);jQuery('#toggle-grid').removeClass('toggle-active');}
jQuery('#results-container').addClass('results-view-list');}});jQuery('.b-single-post--joint-submission-block').click(function(){jQuery('.b-single-post--joint-submission-block').removeClass('active');jQuery(this).addClass('active');if(jQuery(this).data('type')=='multiple'){jQuery('.b-single-post--joint-submission-description, .b-single-post--joint-submission-users').show();jQuery('#jointSubmissionIdea').attr('checked',true);jQuery('#submission_type').val('multiple');}else{jQuery('.b-single-post--joint-submission-description, .b-single-post--joint-submission-users').hide();jQuery('#jointSubmissionIdea').attr('checked',false);jQuery('#submission_type').val('single');}});var lisitngLeaveOpen=false;jQuery('.b-idea__avatars--multiple').off();jQuery('.b-idea__joint-users').off();jQuery('.b-idea__avatars--multiple').on('mouseover',function(){var postId=jQuery(this).data('id');jQuery('#b-idea__joint-users-'+postId).show();});jQuery('.b-idea__avatars--multiple').on("mouseleave",function(){setTimeout(function(){if(!lisitngLeaveOpen){jQuery('.b-idea__joint-users').hide();}},500);});jQuery('.b-idea__joint-users').on("mouseleave",function(){setTimeout(function(){lisitngLeaveOpen=false;jQuery('.b-idea__joint-users').hide();},500);});jQuery('.b-idea__joint-users').on("mouseover",function(){lisitngLeaveOpen=true;});var leaveOpen=false;jQuery('.b-single-idea__joint-submission-authors').mouseover(function(){jQuery('.b-single-idea__author-list').show();jQuery('.b-header--fixed').css('z-index',1);});jQuery('.b-single-idea__joint-submission-authors').mouseleave(function(e){setTimeout(function(){if(!leaveOpen){jQuery('.b-single-idea__author-list').hide();jQuery('.b-header--fixed').css('z-index',700);}},500);});jQuery('.b-single-idea__author-list').mouseover(function(){leaveOpen=true;});jQuery('.b-single-idea__author-list').mouseleave(function(){leaveOpen=false;setTimeout(function(){jQuery('.b-single-idea__author-list').hide();jQuery('.b-header--fixed').css('z-index',700);},500);});jQuery('#remove_from_submission').off();jQuery('#remove_from_submission').on("click",function(){var confirm=window.confirm("Do you wish to remove yourself as a co-author of this idea?");if(confirm){var user_id=jQuery(this).data('user');var post_id=jQuery(this).data('post');jQuery.ajax("/post/remove_user_from_joint_submission",{data:{user_id:user_id,post_id:post_id},type:"post",success:function(data){jQuery.ajax('/post/'+post_id+'?postType=viewPostLowerFold',{success:function(data){jQuery('#idea_lowerFold').html(data);document.fire("crowdworks:updateComplete");}});}});}
return false;});jQuery('.b-single-idea__edit-timestamp--expand').click(function(e){e.preventDefault();jQuery('.b-single-idea__edit-timestamp').show();jQuery(this).hide();});jQuery(".timeline-readmore").off();jQuery(".timeline-readmore").on("click",function(event){event.stopImmediatePropagation();event.stopPropagation();event.preventDefault();console.log(".timeline-readmore click");jQuery(".b-single-challenge__timeline-section-info .b-excerpt").hide();jQuery(".b-single-challenge__timeline-section-details").removeClass("b-single-challenge__timeline-section-details-active");jQuery(this).closest(".b-single-challenge__timeline-section-details").toggleClass("b-single-challenge__timeline-section-details-active");});jQuery("#results-sort").off();jQuery("#results-sort").on('change',function(){console.log("sort: "+jQuery("#results-sort").val());var sortBy=jQuery(this).find(':selected').val();var phaseId=jQuery('#selectedPhase').val();jQuery('#loadMoreButton').remove();var id=jQuery('#challenge_id').val();jQuery.ajax('/category/'+id,{data:{sortBy:sortBy,forPhase:phaseId},success:function(data){jQuery('#results-container').html(data);var selectedTags=[];var selectedThemes=[];if(jQuery('#active_tag_filters').val()){var selectedTags=jQuery('#active_tag_filters').val().split(',');}
if(jQuery('#active_theme_filters').val()){var selectedThemes=jQuery('#active_theme_filters').val().split(',');}
jQuery('#results-container').mixItUp('sort',jQuery("#results-sort").val());var x;if(selectedTags.length||selectedThemes.length){jQuery('.b-idea__container').each(function(){for(x=0;x<selectedTags.length;x++){var selectedTag=selectedTags[x];if(jQuery(this).hasClass('tag-'+selectedTag)){jQuery(this).show();}}
for(x=0;x<selectedThemes;x++){var selectedTheme=selectedThemes[x];if(jQuery(this).hasClass('filter-'+selectedTheme)){jQuery(this).show();}}});}else{jQuery('.b-idea__container').each(function(){jQuery(this).show();});}
bindIdeaPreviewClick();tipInit();}});});jQuery(".timeline-close").off();jQuery(".timeline-close").on("click",function(event){event.preventDefault();jQuery(".b-single-challenge__timeline-section-details").removeClass("b-single-challenge__timeline-section-details-active");jQuery(this).parent().parent().find(".b-excerpt").delay(500).slideDown(500);});jQuery('.i-phase').off();jQuery('.i-phase').on("click",function(event){event.preventDefault();if((!jQuery(this).hasClass('i-phase--disabled'))&&(!jQuery(this).hasClass('b-single-challenge__timeline-section--active'))){jQuery('.i-phase--active').removeClass('b-single-challenge__timeline-section--active i-phase--active');jQuery(this).addClass('b-single-challenge__timeline-section--active i-phase--active');jQuery(".b-single-challenge__timeline-section-info .b-excerpt").hide();console.log("timeline panel click");jQuery(this).find(".b-excerpt").delay(500).slideDown(500);jQuery('#selectedPhase').val(jQuery(this).data('phase-id'));loadIdeas(jQuery(this).data('category-id'),jQuery(this).data('phase-id'));if(!Modernizr.flexbox){setSizes();}}});jQuery(".b-idea__vote--awardpoints-trigger").off();jQuery(".b-idea__vote--awardpoints-trigger").on("click",function(e){jQuery(this).parent().parent().find(".b-idea__vote--awardpoints-popup").show();});jQuery(".b-idea__vote--awardpoints-popup-right").off();jQuery(".b-idea__vote--awardpoints-popup-right").on("click",function(e){jQuery(this).parent().hide();});jQuery(".b-idea__vote--awardpoints-popup ul li").off();jQuery(".b-idea__vote--awardpoints-popup ul li").on("click",function(e){jQuery(this).parent().parent().parent().hide();});jQuery('.i-sidebar__section-expand-button').off();jQuery('.i-sidebar__section-expand-button').on("click",function(event){event.stopImmediatePropagation();event.stopPropagation();event.preventDefault();jQuery(this).parent().next().toggleClass('b-collapsed i-collapsed').slideToggle();jQuery(this).toggleClass('b-icon--caret-down').toggleClass('b-icon--caret-up');});jQuery('.tip').tipr();challengeFilters.init();resultFilters.init();initialiseMixItUp(false);jQuery('#results-container').mixItUp('filter','.filter-active');jQuery(".more-tags").off();jQuery(".more-tags").on('click',function(e){e.preventDefault();jQuery("#tags-modal").toggleClass("b-single-challenge__tags-modal");});jQuery(".more-tags-cancel").off();jQuery(".more-tags-cancel").on('click',function(e){e.preventDefault();resultFilters.resetFilters();resultFilters.parseFilters();jQuery("#tags-modal").toggleClass("b-single-challenge__tags-modal");});jQuery(".b-social-icon--expand").off();jQuery(".b-social-icon--expand").on('click',function(e){e.preventDefault();jQuery(".b-header__action-social").toggleClass("b-header__action-social-active");if(jQuery(".b-header__action-social").hasClass("b-header__action-social-active")){jQuery("#social-toggle").removeClass("icon-menu");jQuery("#social-toggle").addClass("icon-more2");}else{jQuery("#social-toggle").addClass("icon-menu");jQuery("#social-toggle").removeClass("icon-more2");}});jQuery(".intro-more").off();jQuery(".intro-more").on('click',function(e){e.preventDefault();jQuery(".b-single-challenge__intro-excerpt a").fadeToggle();jQuery(".b-single-challenge__intro-full").slideToggle(1000);});Comment.bindCommentEvents();jQuery(".b-single-idea__follower-expand").off();jQuery(".b-single-idea__follower-expand").on('click',function(e){e.preventDefault();jQuery(".b-single-idea__follower-more").fadeOut(500);jQuery(".b-single-idea__follower").show(500);});var triggerMilestonePanel=jQuery('#show_label_icon').val();if(triggerMilestonePanel){setTimeout(function(){jQuery(".progressBarLabel").on("click",function(e){jQuery(".milestone-viewer-box-info").hide();jQuery("#milestone-viewer-box-0").show();if(!jQuery(".milestone-viewer-box").is(':visible')){jQuery(".milestone-viewer-box").slideDown();jQuery(".progressBarLabel").addClass("progressBarLabel-active");}else{jQuery(".milestone-viewer-box").slideUp();jQuery(".progressBarLabel").removeClass("progressBarLabel-active");}});jQuery(".milestone-viewer-box-info").hide();jQuery("#milestone-viewer-box-0").show();if(!jQuery(".milestone-viewer-box").is(':visible')){jQuery(".milestone-viewer-box").slideDown();jQuery(".progressBarLabel").addClass("progressBarLabel-active");}else{jQuery(".milestone-viewer-box").slideUp();jQuery(".progressBarLabel").removeClass("progressBarLabel-active");}
jQuery(".milestone-viewer-box-close").on("click",function(e){jQuery(".milestone-viewer-box").slideUp();jQuery(".progressBarLabel").removeClass("progressBarLabel-active");});jQuery(".milestoneInfoToggle").on("click",function(e){jQuery(".milestone-viewer-box-info").hide();jQuery("#milestone-viewer-box-"+jQuery(this).attr("data-id")).show();if(!jQuery(".milestone-viewer-box").is(':visible')){jQuery(".milestone-viewer-box").slideDown();};});},1000);}
var milestoneTimers=[];jQuery('.b-idea__time-left-details').each(function(){if(jQuery(this).data('timertrigger')){var d=jQuery(this).find('.b-idea__time-left-days').text(),h=jQuery(this).find('.b-idea__time-left-hours').text(),m=jQuery(this).find('.b-idea__time-left-mins').text(),s=jQuery(this).find('.b-idea__time-left-secs').text();var id=jQuery(this).data('id');var that=this;milestoneTimers[id]=setInterval(function(){if(s>0){s=parseInt(s)-1;}else if(s===0){s=59;if(m>0){m=parseInt(m)-1;}else if(m===0){m=59;if(h>0){h=parseInt(h)-1;}else if(h===0){h=23;if(d>0){d=parseInt(d)-1;}}}}
jQuery(that).find('.b-idea__time-left-days').html(d);jQuery(that).find('.b-idea__time-left-hours').html(h);jQuery(that).find('.b-idea__time-left-mins').html(m);jQuery(that).find('.b-idea__time-left-secs').html(s);},1000);}});jQuery('.b-idea__time-left').each(function(){var id=jQuery(this).data('id');jQuery(this).hover(function(e){jQuery('#b-idea__time-left-details-'+id).show();},function(e){jQuery('#b-idea__time-left-details-'+id).hide();});});updateIdeaNextPreviousBar();bindIdeaPreviewClick();if(!Modernizr.flexbox){setSizes();}
jQuery('.milestone-circle-tooltip').each(function(){var desc=jQuery(this).val();var id=jQuery(this).data('id');$('milestoneCircle-'+id).addTip(desc,ttoptions);});var user_notified=false;jQuery('.b-voting-types li').each(function(){jQuery(this).on("click",function(e){e.preventDefault();var $parent=jQuery(this).parent(),confirm=true;if(!user_notified&&$parent.data('hasvotes')){confirm=window.confirm("There are ideas in this challenge that have received votes associated with your current voting type. If you change the voting type, the idea scores will be reset.\n\nIf you do change your voting type, you can revert to your original voting type at any time, and the associated scores will be remembered.")
user_notified=true;}
if(confirm){var a=jQuery(this).find('a');var type=jQuery(a).data('type');jQuery('.voting-type-icon').each(function(){jQuery(this).removeClass('icon-radio-checked').addClass('icon-radio-unchecked');});jQuery(this).find('.voting-type-icon').addClass('icon-radio-checked').removeClass('icon-radio-unchecked');jQuery('.b-voting-types li').each(function(){jQuery(this).removeClass('active');});jQuery(this).addClass('active');jQuery('#votingSchemeInput').val(type);jQuery('.voting_type_tab').each(function(){jQuery(this).hide();});jQuery('#voting_'+type).show();}
return false;});});jQuery('#scorecard_challenge_select').on("change",function(e){var categoryId=jQuery(this).find('option:selected').val();var tpl='';var type=jQuery(this).find('option:selected').data('type');jQuery('.b-scorecard-criteria').not('.base_criteria_tpl').each(function(){jQuery(this).remove();});if(categoryId){jQuery.ajax('/category/admin_get_scorecard_criteria/'+categoryId,{data:{type:type},dataType:'json',success:function(data){for(var i=0;i<data.length;i++){tpl=jQuery('.base_criteria_tpl').clone();jQuery(tpl).removeClass('base_criteria_tpl');jQuery(tpl).find('input:first-child').attr('name','scorecard_criteria_title_new['+parseInt(i+1)+']');jQuery(tpl).find('input:first-child').val(data[i].scorecard_label);jQuery(tpl).find('input:last-child').attr('name','scorecard_criteria_description_new['+parseInt(i+1)+']');jQuery(tpl).find('input:last-child').val(data[i].scorecard_description);jQuery(tpl).find('.b-criteria-delete-new').on("click",function(){jQuery(this).parents('.b-scorecard-criteria').remove();});jQuery('#criteria-holder').append(tpl);}
jQuery('#criteria-holder').append(jQuery('.base_criteria_tpl'));}});}});jQuery('.b-criteria-delete').each(function(){jQuery(this).on("click",function(){var id=jQuery(this).data('id');var that=this;var confirm=window.confirm("Are you sure? Deleting this will permanently remove all ratings for this criteria");if(confirm){jQuery.ajax('/category/admin_delete_scorecard/'+id,{type:'post',success:function(data){jQuery(that).parents('.b-scorecard-criteria').remove();}});}});});jQuery('.b-criteria-delete-new').not('.b-criteria-delete-disabled').each(function(){jQuery(this).on("click",function(){jQuery(this).parents('.b-scorecard-criteria').remove();});});jQuery('.b-scorecard-add-criteria').on("click",function(e){e.preventDefault();var html=jQuery('.base_criteria_tpl').clone();var count=parseInt(jQuery('#criteria_count').val())+1;jQuery(html).removeClass('base_criteria_tpl');jQuery(html).find('input:first-child').attr('name','scorecard_criteria_title_new['+count+']').val('');jQuery(html).find('input:last-child').attr('name','scorecard_criteria_description_new['+count+']').val('');jQuery('#criteria-holder').append(html);jQuery('#criteria_count').val(count);jQuery(html).find('.b-criteria-delete-new').show().on("click",function(){jQuery(this).parents('.b-scorecard-criteria').remove();});return false;});jQuery('.b-clear-scorecard').on("click",function(e){e.preventDefault();jQuery('.b-scorecard-criteria').not(".b-scorecard-criteria.base_criteria_tpl").each(function(){jQuery(this).remove();});return false;});var baseContainerHeight=jQuery('#fullContainer').height();jQuery('#phaseFormTabs li a').each(function(){jQuery(this).on("click",function(){var $form=jQuery('#phaseForm'),$container=jQuery('#fullContainer');var formTop=$form.offset().top,containerHeight=$container.height(),newHeight=baseContainerHeight+$form.height()-(containerHeight-formTop)+40;$container.height(newHeight);});});jQuery('#voting_tab_link').on("click",function(e){e.preventDefault();jQuery('#categoryFormEditTabs li.selected').removeClass('selected');jQuery('a#tab_voting').parent().addClass('selected');jQuery('#viewtab_catPermissions').hide();jQuery('#viewtab_voting').show();return false;});}
jQuery(document).ready(function(){});function bindIdeaPreviewClick(){jQuery('.b-idea__container a.idea-link').each(function(){jQuery(this).unbind();jQuery(this).click(function(e){e.preventDefault();var id=jQuery(this).closest('.b-idea__container').data('id');Crowdicity.jRouter.go("post/"+id);return false;});});}
function updateIdeaNextPreviousBar(){var prevData=jQuery('#prevPostData');if(prevData.length>0){var nextData=jQuery('#nextPostData');var backToChallengeData=jQuery('#postChallenge');var prevLink=jQuery('#prevPostLink');var nextLink=jQuery('#nextPostLink');var backToChallengeLink=jQuery('#backToChallengeLink');prevLink.attr('data-id',prevData.attr('data-id'));prevLink.attr('data-title',prevData.attr('data-title'));prevLink.attr('data-current-post-id',prevData.attr('data-current-post-id'));$('prevPostLink').addTip(jQuery('<i></i>').text(prevData.attr('data-title')).html(),ttoptionsFixed);if(prevData.attr('data-id')==="0"){jQuery('#prevPostLink').parent().hide();}else{jQuery('#prevPostLink').parent().show();}
nextLink.attr('data-id',nextData.attr('data-id'));nextLink.attr('data-title',nextData.attr('data-title'));nextLink.attr('data-current-post-id',nextData.attr('data-current-post-id'));$('nextPostLink').addTip(jQuery('<i></i>').text(nextData.attr('data-title')).html(),ttoptionsFixed);if(nextLink.attr('data-id')==="0"){jQuery('#nextPostLink').parent().hide();}else{jQuery('#nextPostLink').parent().show();}
backToChallengeLink.attr('data-id',backToChallengeData.attr('data-id'));backToChallengeLink.attr('data-title',backToChallengeData.attr('data-title'));jQuery('#backToChallengeName').text(backToChallengeData.attr('data-title'));Tips.list[0].content=jQuery('<i></i>').text(prevData.attr('data-title')).html();Tips.list[1].content=jQuery('<i></i>').text(nextData.attr('data-title')).html();prevLink.unbind().click(function(){var id=jQuery(this).attr('data-id');var title=jQuery(this).attr('data-title');var currentPostId=jQuery(this).attr('data-current-post-id');Crowdicity.jRouter.go("post/"+id);return false;});nextLink.unbind().click(function(){var id=jQuery(this).attr('data-id');var title=jQuery(this).attr('data-title');var currentPostId=jQuery(this).attr('data-current-post-id');Crowdicity.jRouter.go("post/"+id);return false;});backToChallengeLink.unbind().click(function(){var id=jQuery(this).attr('data-id');var title=jQuery(this).attr('data-title');Crowdicity.jRouter.go("category/"+id);return false;});jQuery('#ideaNextPreviousBar').show();jQuery('#docBody').addClass('post-current-page');}else{jQuery('#ideaNextPreviousBar').hide();jQuery('#docBody').removeClass('post-current-page');}};var lastScrollTop=0;var menuHeight=jQuery(".b-header--menu-wrap").height();var isiPad=navigator.userAgent.match(/iPad/i)!=null;if(!isiPad){jQuery(document).ready(function(){jQuery(window).scroll(function(){var el=".b-header--fixed";var st=jQuery(this).scrollTop();if(st>lastScrollTop&&st>100){if(parseInt(jQuery(el).attr("data-visible"))==1){jQuery(el).animate({top:(menuHeight*-1)},400);jQuery(el).attr("data-visible",0);}}else if(st<lastScrollTop){if(parseInt(jQuery(el).attr("data-visible"))==0){jQuery(el).animate({top:0},400);jQuery(el).attr("data-visible",1);}}
lastScrollTop=st;});});}
jQuery(function(){jQuery(".b-social-icon--expand").off();jQuery(".b-social-icon--expand").on('click',function(e){e.preventDefault();jQuery('.b-header__main-nav-menu li').removeClass("active");jQuery(".b-header__action-social").toggleClass("b-header__action-social-active");if(jQuery(".b-header__action-social").hasClass("b-header__action-social-active")){jQuery("#social-toggle").removeClass("icon-menu");jQuery("#social-toggle").addClass("icon-more2");if(jQuery('.b-header__search').hasClass('b-search--expanded')){toggleSearch();}}else{jQuery("#social-toggle").addClass("icon-menu");jQuery("#social-toggle").removeClass("icon-more2");}});var ex_width=parseInt(jQuery(".b-header__search").offset().left);ex_width=ex_width-(parseInt(jQuery(".b-logo").width())+parseInt(jQuery(".b-logo").offset().left));ex_width=ex_width-100;jQuery(".b-header__main-navigation").css({"max-width":ex_width+"px","width":ex_width+"px"});function toggleSearch(){var ex_width=parseInt(jQuery(".b-header__search").offset().left);ex_width=ex_width-(parseInt(jQuery(".b-logo").width())+parseInt(jQuery(".b-logo").offset().left));ex_width=ex_width-240;jQuery('.b-header__main-nav-menu li').removeClass("active");jQuery('.i-navigation').toggleClass('b-navigation--compressed');jQuery('.i-search__button-close').toggle();jQuery('.b-header__search').toggleClass('b-search--expanded');if(jQuery('.b-header__search').hasClass('b-search--expanded')){jQuery('input.b-search__input').css("width",ex_width+"px");jQuery('.b-search__advanced-button').show();jQuery('.b-search__advanced-button').css("width","140px");jQuery('input.b-search__input').focus();}else{jQuery('input.b-search__input').css("width","0");jQuery('.b-search__advanced-button').hide();jQuery('.b-search__advanced-button').css("width","0");var val=jQuery('.b-search__input').val();var type=jQuery('.b-search__advanced--type-active').data('type');var url='';if(val.length>2){if(type=="ideas"){url+='/category/';var catId=jQuery('.b-search__advanced--row select option:selected').val();url+=catId+'?q='+val+'&qType=ideas';}else if(type=="people"){url+='/user/search?q='+val+'&qType=people';}
window.location.href=url;}}}
jQuery('.i-search__button').on('click',function(e){e.preventDefault();toggleSearch();});jQuery(".b-search__advanced-button span a").on('click',function(e){jQuery('.b-header__main-nav-menu li').removeClass("active");jQuery(".b-search__advanced").slideToggle();});sizeMenu();jQuery(".b-header__action-item-user a").on('click',function(e){if(!jQuery('.b-header__action-item-user').hasClass('b-header__action-item-user-active')){jQuery('.b-header__action-item-user').addClass('b-header__action-item-user-active');jQuery('.b-header__action-item-user-profile').slideDown();Crowdicity.popUpManager.register(function(){jQuery('.b-header__action-item-user-profile').slideUp();jQuery('.b-header__action-item-user').removeClass('b-header__action-item-user-active');});}});});function sizeMenu(){var w=jQuery(window).width();w=w-jQuery('.b-header__side-navigation').width();w=w-jQuery('.b-logo').width();w=w-50;w=w-150;if(w<350){w=250;}
var sub=0;jQuery('.flexMenu-viewMore').removeClass('has-dropdown');jQuery('.flexMenu-viewMore').removeClass('flexMenu-viewMore');jQuery('.b-header__main-nav-menu li ul').remove();jQuery('.b-header__main-nav-menu-more').remove();jQuery('.b-header__main-nav-menu li').show();jQuery('.b-header__main-nav-menu li').removeClass("active");jQuery('.b-header__main-nav-menu li').each(function(index){if(sub===1){jQuery(this).hide();}
if((jQuery(this).position().left>=w)&&(sub===0)){sub=1;jQuery(this).addClass("flexMenu-viewMore");jQuery(this).addClass("has-dropdown");var submenu='<a class="b-header__main-nav-menu-more" href="#" title="View More">More <i class="fa fa-angle-down"></i></a><ul class="flexMenu-popup dropdown">';jQuery('.b-header__main-nav-menu li').each(function(i){if(i>=index){submenu=submenu+'<li>'+jQuery(this).html()+'</li>';}});submenu=submenu+'</ul>';jQuery(this).append(submenu);}});jQuery(".b-search__advanced--type").on("click",function(){jQuery(".b-search__advanced--type").removeClass("b-search__advanced--type-active");jQuery(this).addClass("b-search__advanced--type-active");if(jQuery(this).data('type')=="people"){jQuery('.b-search__advanced-button span a').text('In People');jQuery('#advanced_search_challenge').hide();}else{jQuery('.b-search__advanced-button span a').text('In Ideas');jQuery('#advanced_search_challenge').show();}});jQuery(".b-single-challenge__timeline-section--future").mouseover(function(){var p=jQuery(this);var offset=p.offset();var popupOffset=offset.top-jQuery(window).scrollTop();jQuery(".b-single-challenge__timeline-future-popup").animate({display:'block'},1000);if(popupOffset<200&&jQuery(window).scrollTop()>10){jQuery(".b-single-challenge__timeline-future-popup").addClass("b-single-challenge__timeline-future-popup-bottom");}}).mouseout(function(){jQuery(".b-single-challenge__timeline-future-popup").animate({display:'none'},500);jQuery(".b-single-challenge__timeline-future-popup").removeClass("b-single-challenge__timeline-future-popup-bottom");});jQuery('img.svg').each(function(){var $img=jQuery(this);var imgID=$img.attr('id');var imgClass=$img.attr('class');var imgURL=$img.attr('src');jQuery.get(imgURL,function(data){var $svg=jQuery(data).find('svg');if(typeof imgID!=='undefined'){$svg=$svg.attr('id',imgID);}
if(typeof imgClass!=='undefined'){$svg=$svg.attr('class',imgClass+' replaced-svg');}
$svg=$svg.removeAttr('xmlns:a');$img.replaceWith($svg);},'xml');});}
jQuery(window).on('resize',function(){sizeMenu();});jQuery(function(){jQuery('.b-search__advanced--tag').click(function(){var tag=jQuery(this).text();var oldVal=jQuery('.b-header__search input.b-search__input').val();var newVal=oldVal+'['+tag+']';jQuery('.b-header__search input.b-search__input').val(newVal);});});function openNewIdeaForm(currentCategoryId,categoryId){jQuery(".b-single-post--underlay").fadeToggle();jQuery.ajax('/post/add',{data:{category_id:currentCategoryId},success:function(data){jQuery(".b-single-post--wrapper").html(data).fadeToggle();if(!currentCategoryId){currentCategoryId=jQuery('#current_category_id').val();}
jQuery('#custom_postfields').html('');var postfields=jQuery('#postFields-'+currentCategoryId).clone();var postfieldsOuter=postfields.find('div.postfield-outer');jQuery('#custom_postfields').append(postfieldsOuter);jQuery('#custom_postfields .b-single-post--field textarea').each(function(){jQuery(this).addClass('mceEditor');});var themes=jQuery('#category_themes-'+currentCategoryId).clone();var action=jQuery('#action').val();if(themes.length>0){jQuery(".selected_category_themes-wrap").show();jQuery('#selected_category_themes').html(themes);themes.change(function(){var val=jQuery(this).find('option:selected').val();if(val!=0){jQuery('#post_category').val(val);}else{jQuery('#post_category').val(currentCategoryId);}})
if(action!="add"){jQuery(themes).attr('disabled',1).css('background','#eee');jQuery(themes).change(function(){var selectedTheme=jQuery(this).find(':selected').val();if(selectedTheme!=0){jQuery('#post_category').val(selectedTheme);}});}
if(action!="add"){if(currentCategoryId!=categoryId){jQuery(themes).val(categoryId);}}}else{jQuery(".selected_category_themes-wrap").hide();}
var customHeadings=jQuery('#custom_headings-'+currentCategoryId);var customTitle=customHeadings.find('#category_title_custom-'+currentCategoryId).html();var customSubtitle=customHeadings.find('#category_subtitle_custom-'+currentCategoryId).html();var customDesc=customHeadings.find('#category_description_custom-'+currentCategoryId).html();var customLongDesc=customHeadings.find('#category_longdescription_custom-'+currentCategoryId).html();var customUpload=customHeadings.find('#category_upload_custom-'+currentCategoryId).html();if(customSubtitle==''){customSubtitle='Give your idea a catchy title';}
if(customLongDesc==''){customLongDesc='This is where you detail your idea, please be as descriptive as possible';}
jQuery('#heading_idea_title').html(customTitle);jQuery('#heading_idea_subtitle').html(customSubtitle);jQuery('#heading_idea_description').html(customDesc);jQuery('#heading_idea_longdescription').html(customLongDesc);jQuery('#heading_idea_upload').html(customUpload);var charCount=parseInt(document.getElementById('category_description_characterLimit_custom-'+currentCategoryId).innerHTML);var descElement=$('description');if(charCount>0){if(!descElement.hasClassName('GB_characterLimit')){descElement.addClassName('GB_characterLimit');}
descElement.writeAttribute('data-gbcharacterlimit',charCount);$('description_charCountContainer').show();var rows=parseInt(Math.ceil(charCount/70));if(rows>20){rows=20;}
descElement.writeAttribute('rows',rows);}else{descElement.removeClassName('GB_characterLimit');$('description_charCountContainer').hide();GB_removeCharacterLimit(descElement);descElement.writeAttribute('rows',10);}
tinyMCE.init({mode:"specific_textareas",editor_selector:"mceEditor",theme:"crowdworks",theme_crowdworks_buttons1:"bold,italic,bullist,|,undo,redo",file_browser_callback:"cwMCEFileBrowser",language:"en",width:"537",height:"150",relative_urls:false,remove_script_host:false,convert_urls:false,gecko_spellcheck:true,browser_spellcheck:true,setup:function(ed){ed.onInit.add(function(ed){var el=$(ed.getElement());el.removeClassName("mceEditor");el.addClassName("mceEditor_processed");el.addClassName("mce_processed");ed.show();ed.onKeyPress.add(function(ed,e){var el=$(ed.getElement());if(el.hasClassName('GB_characterLimit')){if(!GB_characterLimitCheckFunc(el,e.keyCode)){e.preventDefault();}}}),ed.onKeyUp.add(function(ed,e){var el=$(ed.getElement());if(el.hasClassName('GB_characterLimit')){GB_characterLimitUpdateOnElement(el,ed);}});if(el.hasClassName('GB_characterLimit')){GB_characterLimitUpdateOnElement(el,ed);}});}});document.fire("crowdworks:updateComplete");}});}
function initPostButton(pageType){}
function initSort(id){}